<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2025-12-14T15:42:31+00:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">DongHyeon Kim’s Blog</title><subtitle>Swift와 크롤링 기술을 통해 안전한 세상을 만들고 싶습니다.</subtitle><author><name>Dong Hyeon</name></author><entry><title type="html">[UIKit] UITableview 개념 정리</title><link href="http://localhost:4000/UITableview-UITableview/" rel="alternate" type="text/html" title="[UIKit] UITableview 개념 정리" /><published>2025-12-14T00:00:00+00:00</published><updated>2025-12-14T00:00:00+00:00</updated><id>http://localhost:4000/%5BUITableview%5D-UITableview</id><content type="html" xml:base="http://localhost:4000/UITableview-UITableview/"><![CDATA[<blockquote>
  <h2 id="uitableview">UITableview</h2>
  <p>사용자 지정 가능한 행으로 구성된 단일 열에 데이터를 표시합니다.</p>
  <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@MainActor</span>
<span class="kd">class</span> <span class="kt">UITableView</span>
</code></pre></div>  </div>
</blockquote>

<h2 id="개념">개념</h2>
<p>테이블 뷰는 행과 섹션으로 나뉜, 세로로 스크롤되는 콘텐츠를 한 열료 표시한다.   <br />
각 행에는 하나의 정보를 기본으로 표시한다. 섹션을 사용하면 관련된 행들을 그룹화할 수 있다.</p>

<h2 id="협업되는-객체">협업되는 객체</h2>
<ol>
  <li><code class="language-plaintext highlighter-rouge">Cell</code>: 셀은 콘텐츠를 시각적으로 표현하는 요소이다.</li>
  <li><code class="language-plaintext highlighter-rouge">Tableview</code> 컨트롤러: 테이블뷰를 관리하는 데 객체를 사용한다. 테이블 관련 기능을 위해 사용한다.</li>
  <li><code class="language-plaintext highlighter-rouge">Datasource</code>: 프로토콜을 채택하고 테이블에 필요한 데이터를 제공한다,</li>
  <li><code class="language-plaintext highlighter-rouge">Delegate</code>: 프로토콜을 채택하고 테이블 내용과 사용자의 상호작용을 관리한다.</li>
</ol>

<h2 id="reference">Reference</h2>
<ul>
  <li><a href="https://developer.apple.com/documentation/uikit/table-views">UITableview Document</a></li>
</ul>]]></content><author><name>Dong Hyeon</name></author><category term="UIKit" /><category term="UITableview" /><summary type="html"><![CDATA[UITableview 사용자 지정 가능한 행으로 구성된 단일 열에 데이터를 표시합니다. @MainActor class UITableView 개념 테이블 뷰는 행과 섹션으로 나뉜, 세로로 스크롤되는 콘텐츠를 한 열료 표시한다. 각 행에는 하나의 정보를 기본으로 표시한다. 섹션을 사용하면 관련된 행들을 그룹화할 수 있다. 협업되는 객체 Cell: 셀은 콘텐츠를 시각적으로 표현하는 요소이다. Tableview 컨트롤러: 테이블뷰를 관리하는 데 객체를 사용한다. 테이블 관련 기능을 위해 사용한다. Datasource: 프로토콜을 채택하고 테이블에 필요한 데이터를 제공한다, Delegate: 프로토콜을 채택하고 테이블 내용과 사용자의 상호작용을 관리한다. Reference UITableview Document]]></summary></entry><entry><title type="html">[DifferenceKit] Swift 컬렉션에 최적화딘 가장 빠른 O(N) diffing 알고리즘</title><link href="http://localhost:4000/DifferenceKit-DifferenceKit/" rel="alternate" type="text/html" title="[DifferenceKit] Swift 컬렉션에 최적화딘 가장 빠른 O(N) diffing 알고리즘" /><published>2025-12-06T00:00:00+00:00</published><updated>2025-12-06T00:00:00+00:00</updated><id>http://localhost:4000/%5BDifferenceKit%5D-DifferenceKit</id><content type="html" xml:base="http://localhost:4000/DifferenceKit-DifferenceKit/"><![CDATA[<h1 id="differencefrom">difference(from:)</h1>
<p>difference(from:)을 이용하면 두 Collection의 차이를 쉽게 구할 수 있다.  <br />
A와 B를 비교할 때 무엇이 추가로 있고 무엇이 없는지 알 수 있다.</p>

<h1 id="reference">Reference</h1>
<ul>
  <li>https://green1229.tistory.com/589</li>
  <li>https://jeong9216.tistory.com/716#google_vignette</li>
</ul>]]></content><author><name>Dong Hyeon</name></author><category term="Swift" /><category term="DifferenceKit" /><summary type="html"><![CDATA[difference(from:) difference(from:)을 이용하면 두 Collection의 차이를 쉽게 구할 수 있다. A와 B를 비교할 때 무엇이 추가로 있고 무엇이 없는지 알 수 있다. Reference https://green1229.tistory.com/589 https://jeong9216.tistory.com/716#google_vignette]]></summary></entry><entry><title type="html">[RxDataSource] 5. 버튼 액션을 Rx로 연결하기</title><link href="http://localhost:4000/RxDataSource-RxDataSource-5/" rel="alternate" type="text/html" title="[RxDataSource] 5. 버튼 액션을 Rx로 연결하기" /><published>2025-09-13T00:00:00+00:00</published><updated>2025-09-13T00:00:00+00:00</updated><id>http://localhost:4000/%5BRxDataSource%5D-RxDataSource-5</id><content type="html" xml:base="http://localhost:4000/RxDataSource-RxDataSource-5/"><![CDATA[<h1 id="기존-코드-개선">기존 코드 개선</h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="kt">UITableViewCell</span><span class="o">.</span><span class="kt">CellStyle</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="kt">String</span><span class="p">?)</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="n">style</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="n">reuseIdentifier</span><span class="p">)</span>
    <span class="nf">makeUI</span><span class="p">()</span>
    <span class="nf">constraints</span><span class="p">()</span>
    
    <span class="c1">// MARK: - 버튼 연결</span>
    <span class="c1">// isDoneSwitch.addTarget(self, action: #selector(handleIsDone), for: .valueChanged)</span>
    <span class="c1">// deleteButton.addTarget(self, action: #selector(handleDeleteButton), for: .touchUpInside)</span>
<span class="p">}</span>

<span class="c1">// MARK: - Rx로 버튼 연결</span>
<span class="kd">func</span> <span class="nf">setRx</span><span class="p">()</span> <span class="p">{</span>
    
    <span class="c1">// MARK: - 초기 이벤트를 버리고 이후부터 모두 전달받겠다</span>
    <span class="cm">/*
    isDoneSwitch.rx.isOn
        .skip(1) // 처음 방출값 무시(초기값 세팅 이벤트 무시)
        .debug("isDoneSwitch 디버그")
        .bind(onNext: { [weak self] isOn in
            guard let self = self, let id = self.cellData?.id else { return }
            self.isDoneChange?(id, isOn)
        })
        .disposed(by: disposeBag)
        */</span>
    
    <span class="c1">// MARK: - 스위치가 valueChanged이벤트를 낼 때만 트리거 하겠다 &amp; 해당시점은 isOn 값을 가져오겠다</span>
    <span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="nf">controlEvent</span><span class="p">(</span><span class="o">.</span><span class="n">valueChanged</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">withLatestFrom</span><span class="p">(</span><span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">isOn</span><span class="p">)</span> <span class="c1">// 토글 후 최신값 가져오기</span>
        <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">isOn</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span><span class="p">,</span> <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="k">self</span><span class="o">.</span><span class="nf">isDoneChange</span><span class="p">?(</span><span class="n">id</span><span class="p">,</span> <span class="n">isOn</span><span class="p">)</span>
        <span class="p">})</span>
        <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
    
    <span class="n">deleteButton</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span>
        <span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"deleteButton 디버그"</span><span class="p">)</span>
        <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span><span class="p">,</span> <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="k">self</span><span class="o">.</span><span class="nf">deleteAction</span><span class="p">?(</span><span class="n">id</span><span class="p">)</span>
        <span class="p">})</span>
        <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>
<p>기존 커스텀 셀의 버튼 연결 방식은 addTarget인데 Rx스럽게 하기 위해 주석처리 및 setRx()함수를 만들었다.   <br />
setRx()은 configure 함수에서 호출하도록 하였다.<br />
지금은 이벤트 처리 자체를 클로저로 주고 있는데 이렇게 말고 deleteButton.rx.tap 자체를 외부에서 넘겨줄 수 있다. deleteActionObservable을 만들어서 외부에서 주입하도록 해보자.</p>

<h1 id="rxtodocell-수정">RxTodoCell 수정</h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">deleteActionObservalble</span><span class="p">:</span> <span class="kt">Observable</span><span class="o">&lt;</span><span class="kt">UUID</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">Observable</span><span class="o">.</span><span class="nf">empty</span><span class="p">()</span>

    <span class="c1">// MARK: - Rx로 버튼 연결</span>
    <span class="kd">func</span> <span class="nf">setRx</span><span class="p">()</span> <span class="p">{</span>
        
        <span class="c1">// MARK: - 초기 이벤트를 버리고 이후부터 모두 전달받겠다</span>
        <span class="cm">/*
        isDoneSwitch.rx.isOn
            .skip(1) // 처음 방출값 무시(초기값 세팅 이벤트 무시)
            .debug("isDoneSwitch 디버그")
            .bind(onNext: { [weak self] isOn in
                guard let self = self, let id = self.cellData?.id else { return }
                self.isDoneChange?(id, isOn)
            })
            .disposed(by: disposeBag)
         */</span>
        
        <span class="c1">// MARK: - 스위치가 valueChanged이벤트를 낼 때만 트리거 하겠다 &amp; 해당시점은 isOn 값을 가져오겠다</span>
        <span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="nf">controlEvent</span><span class="p">(</span><span class="o">.</span><span class="n">valueChanged</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">withLatestFrom</span><span class="p">(</span><span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">isOn</span><span class="p">)</span> <span class="c1">// 토글 후 최신값 가져오기</span>
            <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">isOn</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span><span class="p">,</span> <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                <span class="k">self</span><span class="o">.</span><span class="nf">isDoneChange</span><span class="p">?(</span><span class="n">id</span><span class="p">,</span> <span class="n">isOn</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
        
        <span class="c1">// MARK: - 기존 방식</span>
        <span class="cm">/*
        deleteButton.rx.tap
            .debug("deleteButton 디버그")
            .bind(onNext: { [weak self] _ in
                guard let self = self, let id = self.cellData?.id else { return }
                self.deleteAction?(id)
            })
            .disposed(by: disposeBag)
         */</span>
        
        <span class="c1">// MARK: - 개선된 방식(클로저를 전달안하고싶고 옵저버블로 하고싶다면)</span>
        <span class="n">deleteActionObservalble</span> <span class="o">=</span> <span class="n">deleteButton</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span>
            <span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"deleteButton 디버그"</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">compactMap</span><span class="p">({</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
                <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span>
            <span class="p">})</span>
    <span class="p">}</span>
</code></pre></div></div>
<p>deleteActionObservalble을 선언해주고 기존 방식을 주석처리하고 deleteActionObservalble을 연결해주었다. 나머지는 viewController에서 진행하면 된다.<br />
<br /><br /><br /><br /></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ✅ 2. (더 유연하지만 수동 캐스팅 필요 – RxCocoa)</span>
<span class="n">rxTodosRelay</span>
    <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">myTableView</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">tableView</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="kt">RxTodoCell</span><span class="o">.</span><span class="n">reuseIdentifier</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">RxTodoCell</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kt">UITableViewCell</span><span class="p">()}</span>
        <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">element</span><span class="p">)</span>
        
        <span class="c1">// MARK: - 셀의 delete버튼 선택되었을 때 액션을 여기서 처리</span>
<span class="c1">//                cell.deleteAction = { id in</span>
<span class="c1">//                    let currentTodos = self.rxTodosRelay.value</span>
<span class="c1">//                    let filteredTodos = currentTodos.filter { $0.id != id }</span>
<span class="c1">//                    self.rxTodosRelay.accept(filteredTodos)</span>
<span class="c1">//                }</span>
        
        <span class="c1">// MARK: - 개선방식(bind대신 map도 가능)</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">deleteActionObservalble</span>
            <span class="o">.</span><span class="nf">withUnretained</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"deleteActionObservalble"</span><span class="p">)</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">vc</span><span class="p">,</span> <span class="n">uuid</span> <span class="k">in</span>
                <span class="k">let</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span>
                <span class="k">let</span> <span class="nv">filteredTodos</span> <span class="o">=</span> <span class="n">currentTodos</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">uuid</span> <span class="p">}</span>
                <span class="k">return</span> <span class="n">filteredTodos</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">disposeBag</span><span class="p">)</span>

            
        
        <span class="c1">// MARK: - 셀의 토글 클릭시 액션을 여기서 처리</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">isDoneChange</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">id</span><span class="p">,</span> <span class="n">updatedIsDone</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="k">var</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span>
            <span class="c1">// 일치하는것 찾기</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">foundTodoIndex</span> <span class="o">=</span> <span class="n">currentTodos</span><span class="o">.</span><span class="nf">firstIndex</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">id</span> <span class="p">})</span> <span class="p">{</span>
                <span class="n">currentTodos</span><span class="p">[</span><span class="n">foundTodoIndex</span><span class="p">]</span><span class="o">.</span><span class="n">isDone</span> <span class="o">=</span> <span class="n">updatedIsDone</span>
            <span class="p">}</span>
            <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="n">currentTodos</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">cell</span>
    <span class="p">}</span>
    <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
</code></pre></div></div>
<p>기존 deleteAction을 주석처리후 deleteActionObservalble을 연결해준다 이때 bind대신 map으로 해주어도 된다.<br />
<br /><br /><br /><br /></p>

<h1 id="전체-코드">전체 코드</h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Cell</span>
<span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">RxSwift</span>
<span class="kd">import</span> <span class="kt">RxCocoa</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">RxTodoCell</span><span class="p">:</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">cellData</span><span class="p">:</span> <span class="kt">RxTodo</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>

    <span class="c1">// MARK: - Rx</span>
    <span class="k">var</span> <span class="nv">disposeBag</span> <span class="o">=</span> <span class="kt">DisposeBag</span><span class="p">()</span>
    <span class="k">var</span> <span class="nv">isDoneChange</span><span class="p">:</span> <span class="p">((</span><span class="n">_</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">,</span> <span class="n">_</span> <span class="nv">newValue</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>
    <span class="k">var</span> <span class="nv">deleteAction</span><span class="p">:</span> <span class="p">((</span><span class="n">_</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>
    <span class="k">var</span> <span class="nv">deleteActionObservalble</span><span class="p">:</span> <span class="kt">Observable</span><span class="o">&lt;</span><span class="kt">UUID</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">Observable</span><span class="o">.</span><span class="nf">empty</span><span class="p">()</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">()</span>
        <span class="n">label</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"제목"</span>
        <span class="n">label</span><span class="o">.</span><span class="n">numberOfLines</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">label</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="kt">UIFont</span><span class="o">.</span><span class="nf">systemFont</span><span class="p">(</span><span class="nv">ofSize</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="nv">weight</span><span class="p">:</span> <span class="o">.</span><span class="n">bold</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">idLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">()</span>
        <span class="n">label</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"아이디"</span>
        <span class="n">label</span><span class="o">.</span><span class="n">numberOfLines</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">label</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="kt">UIFont</span><span class="o">.</span><span class="nf">systemFont</span><span class="p">(</span><span class="nv">ofSize</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="nv">weight</span><span class="p">:</span> <span class="o">.</span><span class="n">regular</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">isDoneSwitch</span><span class="p">:</span> <span class="kt">UISwitch</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">sw</span> <span class="o">=</span> <span class="kt">UISwitch</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sw</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">deleteButton</span><span class="p">:</span> <span class="kt">UIButton</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">btn</span> <span class="o">=</span> <span class="kt">UIButton</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="n">system</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="nf">setTitle</span><span class="p">(</span><span class="s">"Delete"</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">normal</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">widthAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalToConstant</span><span class="p">:</span> <span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="n">btn</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">vStack</span><span class="p">:</span> <span class="kt">UIStackView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">stack</span> <span class="o">=</span> <span class="kt">UIStackView</span><span class="p">(</span><span class="nv">arrangedSubviews</span><span class="p">:</span> <span class="p">[</span><span class="n">titleLabel</span><span class="p">,</span> <span class="n">idLabel</span><span class="p">])</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="o">.</span><span class="n">vertical</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">return</span> <span class="n">stack</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">hStack</span><span class="p">:</span> <span class="kt">UIStackView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">stack</span> <span class="o">=</span> <span class="kt">UIStackView</span><span class="p">(</span><span class="nv">arrangedSubviews</span><span class="p">:</span> <span class="p">[</span><span class="n">vStack</span><span class="p">,</span> <span class="n">isDoneSwitch</span><span class="p">,</span> <span class="n">deleteButton</span><span class="p">])</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="o">.</span><span class="n">horizontal</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="o">.</span><span class="n">center</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="k">return</span> <span class="n">stack</span>
    <span class="p">}()</span>

    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="kt">UITableViewCell</span><span class="o">.</span><span class="kt">CellStyle</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="kt">String</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="n">style</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="n">reuseIdentifier</span><span class="p">)</span>
        <span class="nf">makeUI</span><span class="p">()</span>
        <span class="nf">constraints</span><span class="p">()</span>
        
        <span class="c1">// MARK: - 버튼 연결</span>
        <span class="c1">// isDoneSwitch.addTarget(self, action: #selector(handleIsDone), for: .valueChanged)</span>
        <span class="c1">// deleteButton.addTarget(self, action: #selector(handleDeleteButton), for: .touchUpInside)</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - Rx로 버튼 연결</span>
    <span class="kd">func</span> <span class="nf">setRx</span><span class="p">()</span> <span class="p">{</span>
        
        <span class="c1">// MARK: - 초기 이벤트를 버리고 이후부터 모두 전달받겠다</span>
        <span class="cm">/*
        isDoneSwitch.rx.isOn
            .skip(1) // 처음 방출값 무시(초기값 세팅 이벤트 무시)
            .debug("isDoneSwitch 디버그")
            .bind(onNext: { [weak self] isOn in
                guard let self = self, let id = self.cellData?.id else { return }
                self.isDoneChange?(id, isOn)
            })
            .disposed(by: disposeBag)
         */</span>
        
        <span class="c1">// MARK: - 스위치가 valueChanged이벤트를 낼 때만 트리거 하겠다 &amp; 해당시점은 isOn 값을 가져오겠다</span>
        <span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="nf">controlEvent</span><span class="p">(</span><span class="o">.</span><span class="n">valueChanged</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">withLatestFrom</span><span class="p">(</span><span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">isOn</span><span class="p">)</span> <span class="c1">// 토글 후 최신값 가져오기</span>
            <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">isOn</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span><span class="p">,</span> <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                <span class="k">self</span><span class="o">.</span><span class="nf">isDoneChange</span><span class="p">?(</span><span class="n">id</span><span class="p">,</span> <span class="n">isOn</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
        
        <span class="c1">// MARK: - 기존 방식</span>
        <span class="cm">/*
        deleteButton.rx.tap
            .debug("deleteButton 디버그")
            .bind(onNext: { [weak self] _ in
                guard let self = self, let id = self.cellData?.id else { return }
                self.deleteAction?(id)
            })
            .disposed(by: disposeBag)
         */</span>
        
        <span class="c1">// MARK: - 개선된 방식(클로저를 전달안하고싶고 옵저버블로 하고싶다면)</span>
        <span class="n">deleteActionObservalble</span> <span class="o">=</span> <span class="n">deleteButton</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span>
            <span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"deleteButton 디버그"</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">compactMap</span><span class="p">({</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
                <span class="k">self</span><span class="p">?</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span>
            <span class="p">})</span>
    <span class="p">}</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">fatalError</span><span class="p">(</span><span class="s">"init(coder:) has not been implemented"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">makeUI</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">hStack</span><span class="p">]</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">contentView</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span>
            <span class="nv">$0</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">constraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="mi">20</span><span class="p">),</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="o">-</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">),</span>
        <span class="p">])</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">prepareForReuse</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">prepareForReuse</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"prepareForReuse() - cellData.id: </span><span class="se">\(</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="p">??</span> <span class="kt">UUID</span><span class="p">()</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">disposeBag</span> <span class="o">=</span> <span class="kt">DisposeBag</span><span class="p">()</span> <span class="c1">// MARK: - 이전 구독을 끊어주는 작업</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">RxTodoCell</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">configure</span><span class="p">(</span><span class="n">with</span> <span class="nv">todo</span><span class="p">:</span> <span class="kt">RxTodo</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">cellData</span> <span class="o">=</span> <span class="n">todo</span>
        <span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">todo</span><span class="o">.</span><span class="n">title</span>

        <span class="k">let</span> <span class="nv">idString</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="n">todo</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">uuidString</span><span class="o">.</span><span class="nf">prefix</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">idLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"ID: </span><span class="se">\(</span><span class="n">idString</span><span class="se">)</span><span class="s">"</span>
        <span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">isOn</span> <span class="o">=</span> <span class="n">todo</span><span class="o">.</span><span class="n">isDone</span>
        <span class="nf">setRx</span><span class="p">()</span>
    <span class="p">}</span>
 
    <span class="c1">// MARK: - 디버깅용</span>
    <span class="kd">func</span> <span class="nf">configure</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
        <span class="n">idLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"ID: </span><span class="se">\(</span><span class="n">id</span><span class="se">)</span><span class="s">"</span>
        <span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">isOn</span> <span class="o">=</span> <span class="kc">false</span>

    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">RxTodoCell</span> <span class="p">{</span>
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">handleIsDone</span><span class="p">(</span><span class="n">_</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">UISwitch</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- id: </span><span class="se">\(</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">uuidString</span> <span class="p">??</span> <span class="s">""</span><span class="se">)</span><span class="s"> sender: </span><span class="se">\(</span><span class="n">sender</span><span class="o">.</span><span class="n">isOn</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="nf">isDoneChange</span><span class="p">?(</span><span class="n">id</span><span class="p">,</span> <span class="n">sender</span><span class="o">.</span><span class="n">isOn</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">handleDeleteButton</span><span class="p">(</span><span class="n">_</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="nf">deleteAction</span><span class="p">?(</span><span class="n">id</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cp">#if DEBUG</span>
<span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="c1">// TodoCell 미리보기</span>
<span class="kd">struct</span> <span class="kt">RxTodoCell_Preview</span><span class="p">:</span> <span class="kt">PreviewProvider</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="k">var</span> <span class="nv">previews</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="kt">RxTodoCell</span><span class="p">()</span>
        <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"할 일 예제"</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cell</span><span class="o">.</span><span class="n">contentView</span>
            <span class="o">.</span><span class="nf">getPreview</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">previewLayout</span><span class="p">(</span><span class="o">.</span><span class="nf">fixed</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">350</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">100</span><span class="p">))</span>
            <span class="o">.</span><span class="nf">background</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">#endif</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ViewController</span>
<span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">RxSwift</span>
<span class="kd">import</span> <span class="kt">RxCocoa</span>
<span class="kd">import</span> <span class="kt">RxRelay</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">RxTodoViewController4</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="c1">// MARK: - 구독에 대한 찌꺼기 처리</span>
    <span class="k">var</span> <span class="nv">disposeBag</span> <span class="o">=</span>  <span class="kt">DisposeBag</span><span class="p">()</span>
    
    <span class="c1">// MARK: - Relay는 Subject계열인데 끊어지지 않는다(.value로 접근시 마지막 데이터 확인가능 = stateful)</span>
    <span class="k">var</span> <span class="nv">rxTodosRelay</span><span class="p">:</span> <span class="kt">BehaviorRelay</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">RxTodo</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">BehaviorRelay</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="kt">RxTodo</span><span class="o">.</span><span class="nf">getDumies</span><span class="p">())</span>

    <span class="c1">// MARK: - UI</span>
    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">addButton</span> <span class="o">=</span> <span class="kt">UIBarButtonItem</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"추가"</span><span class="p">,</span>
                                                 <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="n">plain</span><span class="p">,</span>
                                                 <span class="nv">target</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span>
                                                 <span class="nv">action</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">myTableView</span><span class="p">:</span> <span class="kt">UITableView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">tv</span> <span class="o">=</span> <span class="kt">UITableView</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">tv</span>
    <span class="p">}()</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span>
        <span class="nf">makeUI</span><span class="p">()</span>
        <span class="nf">constraints</span><span class="p">()</span>
        
        <span class="c1">// MARK: - 코드기반 사용한다면</span>
        <span class="n">myTableView</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="kt">RxTodoCell</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forCellReuseIdentifier</span><span class="p">:</span> <span class="s">"RxTodoCell"</span><span class="p">)</span>

        <span class="c1">// ✅ 2. (더 유연하지만 수동 캐스팅 필요 – RxCocoa)</span>
        <span class="n">rxTodosRelay</span>
            <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">myTableView</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">tableView</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="kt">RxTodoCell</span><span class="o">.</span><span class="n">reuseIdentifier</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">RxTodoCell</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kt">UITableViewCell</span><span class="p">()}</span>
                <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">element</span><span class="p">)</span>
                
                <span class="c1">// MARK: - 셀의 delete버튼 선택되었을 때 액션을 여기서 처리</span>
<span class="c1">//                cell.deleteAction = { id in</span>
<span class="c1">//                    let currentTodos = self.rxTodosRelay.value</span>
<span class="c1">//                    let filteredTodos = currentTodos.filter { $0.id != id }</span>
<span class="c1">//                    self.rxTodosRelay.accept(filteredTodos)</span>
<span class="c1">//                }</span>
                
                <span class="c1">// MARK: - 개선방식(bind대신 map도 가능)</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">deleteActionObservalble</span>
                    <span class="o">.</span><span class="nf">withUnretained</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>
                    <span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"deleteActionObservalble"</span><span class="p">)</span>
                    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">vc</span><span class="p">,</span> <span class="n">uuid</span> <span class="k">in</span>
                        <span class="k">let</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span>
                        <span class="k">let</span> <span class="nv">filteredTodos</span> <span class="o">=</span> <span class="n">currentTodos</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">uuid</span> <span class="p">}</span>
                        <span class="k">return</span> <span class="n">filteredTodos</span>
                    <span class="p">}</span>
                    <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="p">)</span>
                    <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">disposeBag</span><span class="p">)</span>

                   
                
                <span class="c1">// MARK: - 셀의 토글 클릭시 액션을 여기서 처리</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">isDoneChange</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">id</span><span class="p">,</span> <span class="n">updatedIsDone</span> <span class="k">in</span>
                    <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                    <span class="k">var</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span>
                    <span class="c1">// 일치하는것 찾기</span>
                    <span class="k">if</span> <span class="k">let</span> <span class="nv">foundTodoIndex</span> <span class="o">=</span> <span class="n">currentTodos</span><span class="o">.</span><span class="nf">firstIndex</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">id</span> <span class="p">})</span> <span class="p">{</span>
                        <span class="n">currentTodos</span><span class="p">[</span><span class="n">foundTodoIndex</span><span class="p">]</span><span class="o">.</span><span class="n">isDone</span> <span class="o">=</span> <span class="n">updatedIsDone</span>
                    <span class="p">}</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="n">currentTodos</span><span class="p">)</span>
                <span class="p">}</span>
                
                <span class="k">return</span> <span class="n">cell</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
        
        
        <span class="c1">// MARK: - 3초뒤 갱신</span>
        <span class="cm">/*
        DispatchQueue.main.asyncAfter(deadline: .now() + 3) {
            self.rxTodosRelay.accept(RxTodo.getDumies(count: 3))
        }
         */</span>
        
        <span class="c1">// MARK: - Rx스러운 3초뒤 갱신</span>
        <span class="cm">/*
        Observable.just(())
            .delay(.seconds(3), scheduler: MainScheduler.instance) // Observable&lt;Void&gt;
            .map { RxTodo.getDumies(count: 5) }                    // Observable&lt;[RxTodo]&gt;
            .bind(onNext: self.rxTodosRelay.accept(_:))            // 같은 자료형이면 클로저가 들어갈 수 있다
            .disposed(by: disposeBag)
        */</span>
        
        <span class="c1">// MARK: - 버튼 연결</span>
        <span class="n">addButton</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span>
            <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                <span class="k">var</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span> <span class="c1">// .value 하면 마지막에 보낸 데이터 할 수 있음</span>
                <span class="n">currentTodos</span><span class="o">.</span><span class="nf">insert</span><span class="p">(</span><span class="kt">RxTodo</span><span class="p">(),</span> <span class="nv">at</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>       <span class="c1">// 첫번째 열에 넣겠다</span>
                <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="n">currentTodos</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">makeUI</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">myTableView</span><span class="p">]</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span>
            <span class="nv">$0</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">}</span>
        
        <span class="c1">// 네비게이션 버튼</span>
        <span class="n">navigationItem</span><span class="o">.</span><span class="n">rightBarButtonItems</span> <span class="o">=</span> <span class="p">[</span><span class="n">addButton</span><span class="p">]</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">constraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">safeAreaLayoutGuide</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">),</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span>
        <span class="p">])</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h1 id="성능-이슈-해결법">성능 이슈 해결법</h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 커스텀 셀</span>
<span class="k">override</span> <span class="kd">func</span> <span class="nf">prepareForReuse</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">prepareForReuse</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"prepareForReuse() - cellData.id: </span><span class="se">\(</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="p">??</span> <span class="kt">UUID</span><span class="p">()</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="k">self</span><span class="o">.</span><span class="n">disposeBag</span> <span class="o">=</span> <span class="kt">DisposeBag</span><span class="p">()</span> <span class="c1">// MARK: - 이전 구독을 끊어주는 작업을 통해 성능 개선</span>
<span class="p">}</span>

<span class="c1">// ViewController</span>
<span class="c1">// MARK: - 개선방식(bind대신 map도 가능)</span>
<span class="n">cell</span><span class="o">.</span><span class="n">deleteActionObservalble</span>
    <span class="o">.</span><span class="nf">withUnretained</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"deleteActionObservalble 디버그"</span><span class="p">)</span>
    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">vc</span><span class="p">,</span> <span class="n">uuid</span> <span class="k">in</span>
        <span class="k">let</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span>
        <span class="k">let</span> <span class="nv">filteredTodos</span> <span class="o">=</span> <span class="n">currentTodos</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">uuid</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">filteredTodos</span>
    <span class="p">}</span>
    <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">cell</span><span class="o">.</span><span class="n">disposeBag</span><span class="p">)</span> <span class="c1">// self.disposeBag -&gt; ell.disposeBag</span>
</code></pre></div></div>

<hr />
<p>테이블뷰/컬렉션뷰는 셀을 재사용한다.<br />
따라서 셀이 재사용될 때 기존 구독은 끊어줘야 한다.<br />
그렇지 않으면 같은 셀 인스턴스에 구독이 계속 쌓여서 메모리 증가와 이벤트 중복이 발생한다.<br />
해결법: prepareForReuse()에서 disposeBag = DisposeBag()으로 초기화하고, VC에서는 반드시 cell.disposeBag에 구독을 넣는다.</p>

<p>UITableViewCell은 재사용되므로, 셀이 다시 쓰일 때 이전 구독이 남아있으면 이벤트가 중복으로 전달되고 메모리도 증가한다. 이를 방지하기 위해 prepareForReuse()에서 disposeBag을 새로 생성하여 구독을 초기화하고, ViewController에서는 cell.disposeBag에 바인딩한다.</p>]]></content><author><name>Dong Hyeon</name></author><category term="ReactiveX" /><category term="RxDataSource" /><summary type="html"><![CDATA[기존 코드 개선 override init(style: UITableViewCell.CellStyle, reuseIdentifier: String?) { super.init(style: style, reuseIdentifier: reuseIdentifier) makeUI() constraints() // MARK: - 버튼 연결 // isDoneSwitch.addTarget(self, action: #selector(handleIsDone), for: .valueChanged) // deleteButton.addTarget(self, action: #selector(handleDeleteButton), for: .touchUpInside) } // MARK: - Rx로 버튼 연결 func setRx() { // MARK: - 초기 이벤트를 버리고 이후부터 모두 전달받겠다 /* isDoneSwitch.rx.isOn .skip(1) // 처음 방출값 무시(초기값 세팅 이벤트 무시) .debug("isDoneSwitch 디버그") .bind(onNext: { [weak self] isOn in guard let self = self, let id = self.cellData?.id else { return } self.isDoneChange?(id, isOn) }) .disposed(by: disposeBag) */ // MARK: - 스위치가 valueChanged이벤트를 낼 때만 트리거 하겠다 &amp; 해당시점은 isOn 값을 가져오겠다 isDoneSwitch.rx.controlEvent(.valueChanged) .withLatestFrom(isDoneSwitch.rx.isOn) // 토글 후 최신값 가져오기 .bind(onNext: { [weak self] isOn in guard let self = self, let id = self.cellData?.id else { return } self.isDoneChange?(id, isOn) }) .disposed(by: disposeBag) deleteButton.rx.tap .debug("deleteButton 디버그") .bind(onNext: { [weak self] _ in guard let self = self, let id = self.cellData?.id else { return } self.deleteAction?(id) }) .disposed(by: disposeBag) } 기존 커스텀 셀의 버튼 연결 방식은 addTarget인데 Rx스럽게 하기 위해 주석처리 및 setRx()함수를 만들었다. setRx()은 configure 함수에서 호출하도록 하였다. 지금은 이벤트 처리 자체를 클로저로 주고 있는데 이렇게 말고 deleteButton.rx.tap 자체를 외부에서 넘겨줄 수 있다. deleteActionObservable을 만들어서 외부에서 주입하도록 해보자. RxTodoCell 수정 var deleteActionObservalble: Observable&lt;UUID&gt; = Observable.empty() // MARK: - Rx로 버튼 연결 func setRx() { // MARK: - 초기 이벤트를 버리고 이후부터 모두 전달받겠다 /* isDoneSwitch.rx.isOn .skip(1) // 처음 방출값 무시(초기값 세팅 이벤트 무시) .debug("isDoneSwitch 디버그") .bind(onNext: { [weak self] isOn in guard let self = self, let id = self.cellData?.id else { return } self.isDoneChange?(id, isOn) }) .disposed(by: disposeBag) */ // MARK: - 스위치가 valueChanged이벤트를 낼 때만 트리거 하겠다 &amp; 해당시점은 isOn 값을 가져오겠다 isDoneSwitch.rx.controlEvent(.valueChanged) .withLatestFrom(isDoneSwitch.rx.isOn) // 토글 후 최신값 가져오기 .bind(onNext: { [weak self] isOn in guard let self = self, let id = self.cellData?.id else { return } self.isDoneChange?(id, isOn) }) .disposed(by: disposeBag) // MARK: - 기존 방식 /* deleteButton.rx.tap .debug("deleteButton 디버그") .bind(onNext: { [weak self] _ in guard let self = self, let id = self.cellData?.id else { return } self.deleteAction?(id) }) .disposed(by: disposeBag) */ // MARK: - 개선된 방식(클로저를 전달안하고싶고 옵저버블로 하고싶다면) deleteActionObservalble = deleteButton.rx.tap .debug("deleteButton 디버그") .compactMap({ [weak self] _ in self?.cellData?.id }) } deleteActionObservalble을 선언해주고 기존 방식을 주석처리하고 deleteActionObservalble을 연결해주었다. 나머지는 viewController에서 진행하면 된다. // ✅ 2. (더 유연하지만 수동 캐스팅 필요 – RxCocoa) rxTodosRelay .bind(to: myTableView.rx.items) { (tableView, row, element) in guard let cell = tableView.dequeueReusableCell(withIdentifier: RxTodoCell.reuseIdentifier) as? RxTodoCell else { return UITableViewCell()} cell.configure(with: element) // MARK: - 셀의 delete버튼 선택되었을 때 액션을 여기서 처리 // cell.deleteAction = { id in // let currentTodos = self.rxTodosRelay.value // let filteredTodos = currentTodos.filter { $0.id != id } // self.rxTodosRelay.accept(filteredTodos) // } // MARK: - 개선방식(bind대신 map도 가능) cell.deleteActionObservalble .withUnretained(self) .debug("deleteActionObservalble") .map { vc, uuid in let currentTodos = self.rxTodosRelay.value let filteredTodos = currentTodos.filter { $0.id != uuid } return filteredTodos } .bind(to: self.rxTodosRelay) .disposed(by: self.disposeBag) // MARK: - 셀의 토글 클릭시 액션을 여기서 처리 cell.isDoneChange = { [weak self] id, updatedIsDone in guard let self = self else { return } var currentTodos = self.rxTodosRelay.value // 일치하는것 찾기 if let foundTodoIndex = currentTodos.firstIndex(where: { $0.id == id }) { currentTodos[foundTodoIndex].isDone = updatedIsDone } self.rxTodosRelay.accept(currentTodos) } return cell } .disposed(by: disposeBag) 기존 deleteAction을 주석처리후 deleteActionObservalble을 연결해준다 이때 bind대신 map으로 해주어도 된다. 전체 코드 // Cell import UIKit import RxSwift import RxCocoa final class RxTodoCell: UITableViewCell { var cellData: RxTodo? = nil // MARK: - Rx var disposeBag = DisposeBag() var isDoneChange: ((_ id: UUID, _ newValue: Bool) -&gt; Void)? = nil var deleteAction: ((_ id: UUID) -&gt; Void)? = nil var deleteActionObservalble: Observable&lt;UUID&gt; = Observable.empty() private let titleLabel: UILabel = { let label = UILabel() label.text = "제목" label.numberOfLines = 1 label.font = UIFont.systemFont(ofSize: 14, weight: .bold) return label }() private let idLabel: UILabel = { let label = UILabel() label.text = "아이디" label.numberOfLines = 0 label.font = UIFont.systemFont(ofSize: 12, weight: .regular) return label }() private lazy var isDoneSwitch: UISwitch = { let sw = UISwitch() return sw }() private lazy var deleteButton: UIButton = { let btn = UIButton(type: .system) btn.setTitle("Delete", for: .normal) btn.widthAnchor.constraint(equalToConstant: 50).isActive = true return btn }() private lazy var vStack: UIStackView = { let stack = UIStackView(arrangedSubviews: [titleLabel, idLabel]) stack.axis = .vertical stack.spacing = 8 return stack }() private lazy var hStack: UIStackView = { let stack = UIStackView(arrangedSubviews: [vStack, isDoneSwitch, deleteButton]) stack.axis = .horizontal stack.alignment = .center stack.spacing = 20 return stack }() override init(style: UITableViewCell.CellStyle, reuseIdentifier: String?) { super.init(style: style, reuseIdentifier: reuseIdentifier) makeUI() constraints() // MARK: - 버튼 연결 // isDoneSwitch.addTarget(self, action: #selector(handleIsDone), for: .valueChanged) // deleteButton.addTarget(self, action: #selector(handleDeleteButton), for: .touchUpInside) } // MARK: - Rx로 버튼 연결 func setRx() { // MARK: - 초기 이벤트를 버리고 이후부터 모두 전달받겠다 /* isDoneSwitch.rx.isOn .skip(1) // 처음 방출값 무시(초기값 세팅 이벤트 무시) .debug("isDoneSwitch 디버그") .bind(onNext: { [weak self] isOn in guard let self = self, let id = self.cellData?.id else { return } self.isDoneChange?(id, isOn) }) .disposed(by: disposeBag) */ // MARK: - 스위치가 valueChanged이벤트를 낼 때만 트리거 하겠다 &amp; 해당시점은 isOn 값을 가져오겠다 isDoneSwitch.rx.controlEvent(.valueChanged) .withLatestFrom(isDoneSwitch.rx.isOn) // 토글 후 최신값 가져오기 .bind(onNext: { [weak self] isOn in guard let self = self, let id = self.cellData?.id else { return } self.isDoneChange?(id, isOn) }) .disposed(by: disposeBag) // MARK: - 기존 방식 /* deleteButton.rx.tap .debug("deleteButton 디버그") .bind(onNext: { [weak self] _ in guard let self = self, let id = self.cellData?.id else { return } self.deleteAction?(id) }) .disposed(by: disposeBag) */ // MARK: - 개선된 방식(클로저를 전달안하고싶고 옵저버블로 하고싶다면) deleteActionObservalble = deleteButton.rx.tap .debug("deleteButton 디버그") .compactMap({ [weak self] _ in self?.cellData?.id }) } required init?(coder: NSCoder) { fatalError("init(coder:) has not been implemented") } private func makeUI() { [hStack].forEach { contentView.addSubview($0) $0.translatesAutoresizingMaskIntoConstraints = false } } private func constraints() { NSLayoutConstraint.activate([ hStack.topAnchor.constraint(equalTo: contentView.topAnchor, constant: 10), hStack.leadingAnchor.constraint(equalTo: contentView.leadingAnchor, constant: 20), hStack.trailingAnchor.constraint(equalTo: contentView.trailingAnchor, constant: -20), hStack.bottomAnchor.constraint(equalTo: contentView.bottomAnchor, constant: -10), ]) } override func prepareForReuse() { super.prepareForReuse() print(#fileID, #function, #line, "prepareForReuse() - cellData.id: \(cellData?.id ?? UUID())") self.disposeBag = DisposeBag() // MARK: - 이전 구독을 끊어주는 작업 } } extension RxTodoCell { func configure(with todo: RxTodo) { self.cellData = todo titleLabel.text = todo.title let idString = String(todo.id.uuidString.prefix(10)) idLabel.text = "ID: \(idString)" isDoneSwitch.isOn = todo.isDone setRx() } // MARK: - 디버깅용 func configure(title: String, id: Int) { titleLabel.text = title idLabel.text = "ID: \(id)" isDoneSwitch.isOn = false } } extension RxTodoCell { @objc func handleIsDone(_ sender: UISwitch) { print(#fileID, #function, #line, "- id: \(cellData?.id.uuidString ?? "") sender: \(sender.isOn)") guard let id = self.cellData?.id else { return } isDoneChange?(id, sender.isOn) } @objc func handleDeleteButton(_ sender: UIButton) { guard let id = self.cellData?.id else { return } deleteAction?(id) } } #if DEBUG import SwiftUI // TodoCell 미리보기 struct RxTodoCell_Preview: PreviewProvider { static var previews: some View { let cell = RxTodoCell() cell.configure(title: "할 일 예제", id: 42) return cell.contentView .getPreview() .previewLayout(.fixed(width: 350, height: 100)) .background(Color.white) } } #endif // ViewController import UIKit import RxSwift import RxCocoa import RxRelay final class RxTodoViewController4: UIViewController { // MARK: - 구독에 대한 찌꺼기 처리 var disposeBag = DisposeBag() // MARK: - Relay는 Subject계열인데 끊어지지 않는다(.value로 접근시 마지막 데이터 확인가능 = stateful) var rxTodosRelay: BehaviorRelay&lt;[RxTodo]&gt; = BehaviorRelay(value: RxTodo.getDumies()) // MARK: - UI private lazy var addButton = UIBarButtonItem(title: "추가", style: .plain, target: nil, action: nil) private lazy var myTableView: UITableView = { let tv = UITableView() return tv }() override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white makeUI() constraints() // MARK: - 코드기반 사용한다면 myTableView.register(RxTodoCell.self, forCellReuseIdentifier: "RxTodoCell") // ✅ 2. (더 유연하지만 수동 캐스팅 필요 – RxCocoa) rxTodosRelay .bind(to: myTableView.rx.items) { (tableView, row, element) in guard let cell = tableView.dequeueReusableCell(withIdentifier: RxTodoCell.reuseIdentifier) as? RxTodoCell else { return UITableViewCell()} cell.configure(with: element) // MARK: - 셀의 delete버튼 선택되었을 때 액션을 여기서 처리 // cell.deleteAction = { id in // let currentTodos = self.rxTodosRelay.value // let filteredTodos = currentTodos.filter { $0.id != id } // self.rxTodosRelay.accept(filteredTodos) // } // MARK: - 개선방식(bind대신 map도 가능) cell.deleteActionObservalble .withUnretained(self) .debug("deleteActionObservalble") .map { vc, uuid in let currentTodos = self.rxTodosRelay.value let filteredTodos = currentTodos.filter { $0.id != uuid } return filteredTodos } .bind(to: self.rxTodosRelay) .disposed(by: self.disposeBag) // MARK: - 셀의 토글 클릭시 액션을 여기서 처리 cell.isDoneChange = { [weak self] id, updatedIsDone in guard let self = self else { return } var currentTodos = self.rxTodosRelay.value // 일치하는것 찾기 if let foundTodoIndex = currentTodos.firstIndex(where: { $0.id == id }) { currentTodos[foundTodoIndex].isDone = updatedIsDone } self.rxTodosRelay.accept(currentTodos) } return cell } .disposed(by: disposeBag) // MARK: - 3초뒤 갱신 /* DispatchQueue.main.asyncAfter(deadline: .now() + 3) { self.rxTodosRelay.accept(RxTodo.getDumies(count: 3)) } */ // MARK: - Rx스러운 3초뒤 갱신 /* Observable.just(()) .delay(.seconds(3), scheduler: MainScheduler.instance) // Observable&lt;Void&gt; .map { RxTodo.getDumies(count: 5) } // Observable&lt;[RxTodo]&gt; .bind(onNext: self.rxTodosRelay.accept(_:)) // 같은 자료형이면 클로저가 들어갈 수 있다 .disposed(by: disposeBag) */ // MARK: - 버튼 연결 addButton.rx.tap .bind(onNext: { [weak self] _ in guard let self = self else { return } var currentTodos = self.rxTodosRelay.value // .value 하면 마지막에 보낸 데이터 할 수 있음 currentTodos.insert(RxTodo(), at: 0) // 첫번째 열에 넣겠다 self.rxTodosRelay.accept(currentTodos) }) .disposed(by: disposeBag) } private func makeUI() { [myTableView].forEach { view.addSubview($0) $0.translatesAutoresizingMaskIntoConstraints = false } // 네비게이션 버튼 navigationItem.rightBarButtonItems = [addButton] } private func constraints() { NSLayoutConstraint.activate([ myTableView.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor), myTableView.leadingAnchor.constraint(equalTo: view.leadingAnchor), myTableView.trailingAnchor.constraint(equalTo: view.trailingAnchor), myTableView.bottomAnchor.constraint(equalTo: view.bottomAnchor) ]) } } 성능 이슈 해결법 // 커스텀 셀 override func prepareForReuse() { super.prepareForReuse() print(#fileID, #function, #line, "prepareForReuse() - cellData.id: \(cellData?.id ?? UUID())") self.disposeBag = DisposeBag() // MARK: - 이전 구독을 끊어주는 작업을 통해 성능 개선 } // ViewController // MARK: - 개선방식(bind대신 map도 가능) cell.deleteActionObservalble .withUnretained(self) .debug("deleteActionObservalble 디버그") .map { vc, uuid in let currentTodos = self.rxTodosRelay.value let filteredTodos = currentTodos.filter { $0.id != uuid } return filteredTodos } .bind(to: self.rxTodosRelay) .disposed(by: cell.disposeBag) // self.disposeBag -&gt; ell.disposeBag 테이블뷰/컬렉션뷰는 셀을 재사용한다. 따라서 셀이 재사용될 때 기존 구독은 끊어줘야 한다. 그렇지 않으면 같은 셀 인스턴스에 구독이 계속 쌓여서 메모리 증가와 이벤트 중복이 발생한다. 해결법: prepareForReuse()에서 disposeBag = DisposeBag()으로 초기화하고, VC에서는 반드시 cell.disposeBag에 구독을 넣는다. UITableViewCell은 재사용되므로, 셀이 다시 쓰일 때 이전 구독이 남아있으면 이벤트가 중복으로 전달되고 메모리도 증가한다. 이를 방지하기 위해 prepareForReuse()에서 disposeBag을 새로 생성하여 구독을 초기화하고, ViewController에서는 cell.disposeBag에 바인딩한다.]]></summary></entry><entry><title type="html">[RxDataSource] 3. Rx로 테이블 사용해보기</title><link href="http://localhost:4000/RxDataSource-RxDataSource-3/" rel="alternate" type="text/html" title="[RxDataSource] 3. Rx로 테이블 사용해보기" /><published>2025-09-13T00:00:00+00:00</published><updated>2025-09-13T00:00:00+00:00</updated><id>http://localhost:4000/%5BRxDataSource%5D-RxDataSource-3</id><content type="html" xml:base="http://localhost:4000/RxDataSource-RxDataSource-3/"><![CDATA[<h1 id="정리">정리</h1>
<p>기본적인 Rx테이블 사용방법에 대해 코드로 작성하였다.  <br />
셀을 Nib파일로 사용하거나 코드기반으로 사용함에 따라서 register 사용방식이 다르다는 것만 이해하면 된다. 다음 포스팅에서 RxDatasource로 CRUD로 진행해볼 예정이다.</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// MARK: - Nib파일 사용한다면</span>
<span class="k">let</span> <span class="nv">cellNib</span> <span class="o">=</span> <span class="kt">UINib</span><span class="p">(</span><span class="nv">nibName</span><span class="p">:</span> <span class="s">"RxTodoCell"</span><span class="p">,</span> <span class="nv">bundle</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
<span class="n">myTableView</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="n">cellNib</span><span class="p">,</span> <span class="nv">forCellReuseIdentifier</span><span class="p">:</span> <span class="s">"RxTodoCell"</span><span class="p">)</span>

<span class="c1">// MARK: - 코드기반 사용한다면</span>
<span class="n">myTableView</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="kt">RxTodoCell</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forCellReuseIdentifier</span><span class="p">:</span> <span class="s">"RxTodoCell"</span><span class="p">)</span>
</code></pre></div></div>

<h1 id="전체코드">전체코드</h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Model</span>
<span class="kd">import</span> <span class="kt">Fakery</span>
<span class="kd">import</span> <span class="kt">UIKit</span>

<span class="c1">// MARK: - Model</span>
<span class="kd">struct</span> <span class="kt">RxTodo</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">isDone</span><span class="p">:</span> <span class="kt">Bool</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
         <span class="nv">isDone</span><span class="p">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">self</span><span class="o">.</span><span class="n">isDone</span> <span class="o">=</span> <span class="n">isDone</span>
    <span class="p">}</span>

    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">getDumies</span><span class="p">(</span><span class="nv">count</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">RxTodo</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">faker</span> <span class="o">=</span> <span class="kt">Faker</span><span class="p">(</span><span class="nv">locale</span><span class="p">:</span> <span class="s">"ko"</span><span class="p">)</span>
        <span class="k">var</span> <span class="nv">result</span><span class="p">:</span> <span class="p">[</span><span class="kt">RxTodo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">_</span> <span class="k">in</span> <span class="mi">1</span><span class="o">...</span><span class="n">count</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">firstName</span> <span class="o">=</span> <span class="n">faker</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nf">firstName</span><span class="p">()</span>
            <span class="k">let</span> <span class="nv">lastName</span> <span class="o">=</span> <span class="n">faker</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nf">lastName</span><span class="p">()</span>
            <span class="k">let</span> <span class="nv">title</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">lastName</span><span class="se">)</span><span class="s"> </span><span class="se">\(</span><span class="n">firstName</span><span class="se">)</span><span class="s">"</span>
            <span class="n">result</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">RxTodo</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="nv">isDone</span><span class="p">:</span> <span class="kc">false</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Cell</span>
<span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">RxSwift</span>
<span class="kd">import</span> <span class="kt">RxCocoa</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">RxTodoCell</span><span class="p">:</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">cellData</span><span class="p">:</span> <span class="kt">RxTodo</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>

    <span class="c1">// MARK: - Rx</span>
    <span class="k">var</span> <span class="nv">disposeBag</span> <span class="o">=</span> <span class="kt">DisposeBag</span><span class="p">()</span>
    <span class="k">var</span> <span class="nv">deleteActionObservable</span><span class="p">:</span> <span class="kt">Observable</span><span class="o">&lt;</span><span class="kt">UUID</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">Observable</span><span class="o">.</span><span class="nf">empty</span><span class="p">()</span>
    <span class="k">var</span> <span class="nv">updateActionObservable</span><span class="p">:</span> <span class="kt">Observable</span><span class="o">&lt;</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">,</span> <span class="nv">newValue</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">Observable</span><span class="o">.</span><span class="nf">empty</span><span class="p">()</span>


    <span class="kd">private</span> <span class="k">let</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">()</span>
        <span class="n">label</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"제목"</span>
        <span class="n">label</span><span class="o">.</span><span class="n">numberOfLines</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">label</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="kt">UIFont</span><span class="o">.</span><span class="nf">systemFont</span><span class="p">(</span><span class="nv">ofSize</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="nv">weight</span><span class="p">:</span> <span class="o">.</span><span class="n">bold</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">idLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">()</span>
        <span class="n">label</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"아이디"</span>
        <span class="n">label</span><span class="o">.</span><span class="n">numberOfLines</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">label</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="kt">UIFont</span><span class="o">.</span><span class="nf">systemFont</span><span class="p">(</span><span class="nv">ofSize</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="nv">weight</span><span class="p">:</span> <span class="o">.</span><span class="n">regular</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">isDoneSwitch</span><span class="p">:</span> <span class="kt">UISwitch</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">sw</span> <span class="o">=</span> <span class="kt">UISwitch</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sw</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">deleteButton</span><span class="p">:</span> <span class="kt">UIButton</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">btn</span> <span class="o">=</span> <span class="kt">UIButton</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="n">system</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="nf">setTitle</span><span class="p">(</span><span class="s">"Delete"</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">normal</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">widthAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalToConstant</span><span class="p">:</span> <span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="n">btn</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">vStack</span><span class="p">:</span> <span class="kt">UIStackView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">stack</span> <span class="o">=</span> <span class="kt">UIStackView</span><span class="p">(</span><span class="nv">arrangedSubviews</span><span class="p">:</span> <span class="p">[</span><span class="n">titleLabel</span><span class="p">,</span> <span class="n">idLabel</span><span class="p">])</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="o">.</span><span class="n">vertical</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">return</span> <span class="n">stack</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">hStack</span><span class="p">:</span> <span class="kt">UIStackView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">stack</span> <span class="o">=</span> <span class="kt">UIStackView</span><span class="p">(</span><span class="nv">arrangedSubviews</span><span class="p">:</span> <span class="p">[</span><span class="n">vStack</span><span class="p">,</span> <span class="n">isDoneSwitch</span><span class="p">,</span> <span class="n">deleteButton</span><span class="p">])</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="o">.</span><span class="n">horizontal</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="o">.</span><span class="n">center</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="k">return</span> <span class="n">stack</span>
    <span class="p">}()</span>

    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="kt">UITableViewCell</span><span class="o">.</span><span class="kt">CellStyle</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="kt">String</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="n">style</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="n">reuseIdentifier</span><span class="p">)</span>
        <span class="nf">makeUI</span><span class="p">()</span>
        <span class="nf">constraints</span><span class="p">()</span>
        <span class="c1">// setRx()</span>
    <span class="p">}</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">fatalError</span><span class="p">(</span><span class="s">"init(coder:) has not been implemented"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">makeUI</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">hStack</span><span class="p">]</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">contentView</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span>
            <span class="nv">$0</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">constraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="mi">20</span><span class="p">),</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="o">-</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">),</span>
        <span class="p">])</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">prepareForReuse</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">prepareForReuse</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"prepareForReuse() - cellData.id: </span><span class="se">\(</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="p">??</span> <span class="kt">UUID</span><span class="p">()</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">disposeBag</span> <span class="o">=</span> <span class="kt">DisposeBag</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setRx</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="n">updateActionObservable</span> <span class="o">=</span> <span class="n">isDoneSwitch</span>
            <span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">isOn</span>
            <span class="o">.</span><span class="nf">skip</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                 <span class="c1">// 초기값 무시</span>
            <span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"isDoneSwitch"</span><span class="p">)</span>
            <span class="c1">/// nul을 제거하고 유효한 값만 방출하는 오퍼레이터</span>
            <span class="c1">/// self 또는 cellData 존재하지 않을 수 있어서 compactMap 사용</span>
            <span class="o">.</span><span class="n">compactMap</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">isOn</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">,</span> <span class="nv">newValue</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)?</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span><span class="p">,</span>
                      <span class="k">let</span> <span class="nv">inWrappedId</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kc">nil</span>
                <span class="p">}</span>
                <span class="c1">// return (id: inWrappedId, newValue: self.isDoneSwitch.isOn)</span>
                <span class="nf">return</span> <span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">inWrappedId</span><span class="p">,</span> <span class="nv">newValue</span><span class="p">:</span> <span class="n">isOn</span><span class="p">)</span>
            <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">RxTodoCell</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">configure</span><span class="p">(</span><span class="n">with</span> <span class="nv">todo</span><span class="p">:</span> <span class="kt">RxTodo</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">cellData</span> <span class="o">=</span> <span class="n">todo</span>
        <span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">todo</span><span class="o">.</span><span class="n">title</span>

        <span class="k">let</span> <span class="nv">idString</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="n">todo</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">uuidString</span><span class="o">.</span><span class="nf">prefix</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">idLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"ID: </span><span class="se">\(</span><span class="n">idString</span><span class="se">)</span><span class="s">"</span>
        <span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">isOn</span> <span class="o">=</span> <span class="n">todo</span><span class="o">.</span><span class="n">isDone</span>
        <span class="nf">setRx</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="c1">// MARK: - 디버깅용</span>
    <span class="kd">func</span> <span class="nf">configure</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
        <span class="n">idLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"ID: </span><span class="se">\(</span><span class="n">id</span><span class="se">)</span><span class="s">"</span>
        <span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">isOn</span> <span class="o">=</span> <span class="kc">false</span>

    <span class="p">}</span>
<span class="p">}</span>

<span class="cp">#if DEBUG</span>
<span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="c1">// TodoCell 미리보기</span>
<span class="kd">struct</span> <span class="kt">RxTodoCell_Preview</span><span class="p">:</span> <span class="kt">PreviewProvider</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="k">var</span> <span class="nv">previews</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="kt">RxTodoCell</span><span class="p">()</span>
        <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"할 일 예제"</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cell</span><span class="o">.</span><span class="n">contentView</span>
            <span class="o">.</span><span class="nf">getPreview</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">previewLayout</span><span class="p">(</span><span class="o">.</span><span class="nf">fixed</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">350</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">100</span><span class="p">))</span>
            <span class="o">.</span><span class="nf">background</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">#endif</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ViewController</span>
<span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">RxSwift</span>
<span class="kd">import</span> <span class="kt">RxCocoa</span>
<span class="kd">import</span> <span class="kt">RxRelay</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">RxTodoViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="c1">// MARK: - 구독에 대한 찌꺼기 처리</span>
    <span class="k">var</span> <span class="nv">disposeBag</span> <span class="o">=</span>  <span class="kt">DisposeBag</span><span class="p">()</span>

    <span class="c1">// MARK: - UI</span>
    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">addButton</span> <span class="o">=</span> <span class="kt">UIBarButtonItem</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"추가"</span><span class="p">,</span>
                                                 <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="n">plain</span><span class="p">,</span>
                                                 <span class="nv">target</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span>
                                                 <span class="nv">action</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">myTableView</span><span class="p">:</span> <span class="kt">UITableView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">tv</span> <span class="o">=</span> <span class="kt">UITableView</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">tv</span>
    <span class="p">}()</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span>
        <span class="nf">makeUI</span><span class="p">()</span>
        <span class="nf">constraints</span><span class="p">()</span>
        
        <span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="kt">Observable</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">RxTodo</span><span class="p">]</span><span class="o">&gt;.</span><span class="nf">just</span><span class="p">(</span><span class="kt">RxTodo</span><span class="o">.</span><span class="nf">getDumies</span><span class="p">())</span>
        
        <span class="c1">// MARK: - Nib파일 사용한다면</span>
        <span class="c1">// let cellNib = UINib(nibName: "RxTodoCell", bundle: nil)</span>
        <span class="c1">// myTableView.register(cellNib, forCellReuseIdentifier: "RxTodoCell")</span>
        
        <span class="c1">// MARK: - 코드기반 사용한다면</span>
        <span class="n">myTableView</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="kt">RxTodoCell</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forCellReuseIdentifier</span><span class="p">:</span> <span class="s">"RxTodoCell"</span><span class="p">)</span>

        
        <span class="n">data</span><span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">myTableView</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="nf">items</span><span class="p">(</span><span class="nv">cellIdentifier</span><span class="p">:</span> <span class="s">"RxTodoCell"</span><span class="p">,</span> <span class="nv">cellType</span><span class="p">:</span> <span class="kt">RxTodoCell</span><span class="o">.</span><span class="k">self</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">index</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">cell</span> <span class="k">in</span>
            <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">model</span><span class="p">)</span>
            
        <span class="p">}</span>
        <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">makeUI</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">myTableView</span><span class="p">]</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span>
            <span class="nv">$0</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">}</span>
        
        <span class="c1">// 네비게이션 버튼</span>
        <span class="n">navigationItem</span><span class="o">.</span><span class="n">rightBarButtonItems</span> <span class="o">=</span> <span class="p">[</span><span class="n">addButton</span><span class="p">]</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">constraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">safeAreaLayoutGuide</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">),</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span>
        <span class="p">])</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>]]></content><author><name>Dong Hyeon</name></author><category term="ReactiveX" /><category term="RxDataSource" /><summary type="html"><![CDATA[정리 기본적인 Rx테이블 사용방법에 대해 코드로 작성하였다. 셀을 Nib파일로 사용하거나 코드기반으로 사용함에 따라서 register 사용방식이 다르다는 것만 이해하면 된다. 다음 포스팅에서 RxDatasource로 CRUD로 진행해볼 예정이다. // MARK: - Nib파일 사용한다면 let cellNib = UINib(nibName: "RxTodoCell", bundle: nil) myTableView.register(cellNib, forCellReuseIdentifier: "RxTodoCell") // MARK: - 코드기반 사용한다면 myTableView.register(RxTodoCell.self, forCellReuseIdentifier: "RxTodoCell") 전체코드 // Model import Fakery import UIKit // MARK: - Model struct RxTodo { let id: UUID = UUID() let title: String var isDone: Bool init(title: String, isDone: Bool = false ) { self.title = title self.isDone = isDone } static func getDumies(count: Int = 10) -&gt; [RxTodo] { let faker = Faker(locale: "ko") var result: [RxTodo] = [] for _ in 1...count { let firstName = faker.name.firstName() let lastName = faker.name.lastName() let title = "\(lastName) \(firstName)" result.append(RxTodo(title: title, isDone: false)) } return result } } // Cell import UIKit import RxSwift import RxCocoa final class RxTodoCell: UITableViewCell { var cellData: RxTodo? = nil // MARK: - Rx var disposeBag = DisposeBag() var deleteActionObservable: Observable&lt;UUID&gt; = Observable.empty() var updateActionObservable: Observable&lt;(id: UUID, newValue: Bool)&gt; = Observable.empty() private let titleLabel: UILabel = { let label = UILabel() label.text = "제목" label.numberOfLines = 1 label.font = UIFont.systemFont(ofSize: 14, weight: .bold) return label }() private let idLabel: UILabel = { let label = UILabel() label.text = "아이디" label.numberOfLines = 0 label.font = UIFont.systemFont(ofSize: 12, weight: .regular) return label }() private lazy var isDoneSwitch: UISwitch = { let sw = UISwitch() return sw }() private lazy var deleteButton: UIButton = { let btn = UIButton(type: .system) btn.setTitle("Delete", for: .normal) btn.widthAnchor.constraint(equalToConstant: 50).isActive = true return btn }() private lazy var vStack: UIStackView = { let stack = UIStackView(arrangedSubviews: [titleLabel, idLabel]) stack.axis = .vertical stack.spacing = 8 return stack }() private lazy var hStack: UIStackView = { let stack = UIStackView(arrangedSubviews: [vStack, isDoneSwitch, deleteButton]) stack.axis = .horizontal stack.alignment = .center stack.spacing = 20 return stack }() override init(style: UITableViewCell.CellStyle, reuseIdentifier: String?) { super.init(style: style, reuseIdentifier: reuseIdentifier) makeUI() constraints() // setRx() } required init?(coder: NSCoder) { fatalError("init(coder:) has not been implemented") } private func makeUI() { [hStack].forEach { contentView.addSubview($0) $0.translatesAutoresizingMaskIntoConstraints = false } } private func constraints() { NSLayoutConstraint.activate([ hStack.topAnchor.constraint(equalTo: contentView.topAnchor, constant: 10), hStack.leadingAnchor.constraint(equalTo: contentView.leadingAnchor, constant: 20), hStack.trailingAnchor.constraint(equalTo: contentView.trailingAnchor, constant: -20), hStack.bottomAnchor.constraint(equalTo: contentView.bottomAnchor, constant: -10), ]) } override func prepareForReuse() { super.prepareForReuse() print(#fileID, #function, #line, "prepareForReuse() - cellData.id: \(cellData?.id ?? UUID())") self.disposeBag = DisposeBag() } private func setRx() { print(#fileID, #function, #line, "- ") updateActionObservable = isDoneSwitch .rx.isOn .skip(1) // 초기값 무시 .debug("isDoneSwitch") /// nul을 제거하고 유효한 값만 방출하는 오퍼레이터 /// self 또는 cellData 존재하지 않을 수 있어서 compactMap 사용 .compactMap { [weak self] isOn -&gt; (id: UUID, newValue: Bool)? in guard let self = self, let inWrappedId = self.cellData?.id else { return nil } // return (id: inWrappedId, newValue: self.isDoneSwitch.isOn) return (id: inWrappedId, newValue: isOn) } } } extension RxTodoCell { func configure(with todo: RxTodo) { self.cellData = todo titleLabel.text = todo.title let idString = String(todo.id.uuidString.prefix(10)) idLabel.text = "ID: \(idString)" isDoneSwitch.isOn = todo.isDone setRx() } // MARK: - 디버깅용 func configure(title: String, id: Int) { titleLabel.text = title idLabel.text = "ID: \(id)" isDoneSwitch.isOn = false } } #if DEBUG import SwiftUI // TodoCell 미리보기 struct RxTodoCell_Preview: PreviewProvider { static var previews: some View { let cell = RxTodoCell() cell.configure(title: "할 일 예제", id: 42) return cell.contentView .getPreview() .previewLayout(.fixed(width: 350, height: 100)) .background(Color.white) } } #endif // ViewController import UIKit import RxSwift import RxCocoa import RxRelay final class RxTodoViewController: UIViewController { // MARK: - 구독에 대한 찌꺼기 처리 var disposeBag = DisposeBag() // MARK: - UI private lazy var addButton = UIBarButtonItem(title: "추가", style: .plain, target: nil, action: nil) private lazy var myTableView: UITableView = { let tv = UITableView() return tv }() override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white makeUI() constraints() let data = Observable&lt;[RxTodo]&gt;.just(RxTodo.getDumies()) // MARK: - Nib파일 사용한다면 // let cellNib = UINib(nibName: "RxTodoCell", bundle: nil) // myTableView.register(cellNib, forCellReuseIdentifier: "RxTodoCell") // MARK: - 코드기반 사용한다면 myTableView.register(RxTodoCell.self, forCellReuseIdentifier: "RxTodoCell") data.bind(to: myTableView.rx.items(cellIdentifier: "RxTodoCell", cellType: RxTodoCell.self)) { index, model, cell in cell.configure(with: model) } .disposed(by: disposeBag) } private func makeUI() { [myTableView].forEach { view.addSubview($0) $0.translatesAutoresizingMaskIntoConstraints = false } // 네비게이션 버튼 navigationItem.rightBarButtonItems = [addButton] } private func constraints() { NSLayoutConstraint.activate([ myTableView.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor), myTableView.leadingAnchor.constraint(equalTo: view.leadingAnchor), myTableView.trailingAnchor.constraint(equalTo: view.trailingAnchor), myTableView.bottomAnchor.constraint(equalTo: view.bottomAnchor) ]) } }]]></summary></entry><entry><title type="html">[RxDataSource] 4. 버튼 액션을 클로저 이벤트로 전달하기</title><link href="http://localhost:4000/RxDataSource-RxDataSource-4/" rel="alternate" type="text/html" title="[RxDataSource] 4. 버튼 액션을 클로저 이벤트로 전달하기" /><published>2025-09-13T00:00:00+00:00</published><updated>2025-09-13T00:00:00+00:00</updated><id>http://localhost:4000/%5BRxDataSource%5D-RxDataSource-4</id><content type="html" xml:base="http://localhost:4000/RxDataSource-RxDataSource-4/"><![CDATA[<h1 id="기존-코드-개선">기존 코드 개선</h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// MARK: - 한번 그려지고 끝나기 때문에 추가/삭제같은 이벤트를 반영할 수 없다.</span>
<span class="k">let</span> <span class="nv">data</span> <span class="o">=</span> <span class="kt">Observable</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">RxTodo</span><span class="p">]</span><span class="o">&gt;.</span><span class="nf">just</span><span class="p">(</span><span class="kt">RxTodo</span><span class="o">.</span><span class="nf">getDumies</span><span class="p">())</span>
<span class="n">data</span><span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">myTableView</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="nf">items</span><span class="p">(</span><span class="nv">cellIdentifier</span><span class="p">:</span> <span class="s">"RxTodoCell"</span><span class="p">,</span> <span class="nv">cellType</span><span class="p">:</span> <span class="kt">RxTodoCell</span><span class="o">.</span><span class="k">self</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">index</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">cell</span> <span class="k">in</span>
    <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">model</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// =&gt; BehaviorRelay를 사용하여 단발성이 아닌 변화가능한 상태를 가진 스트림을 만들어서 사용하자.</span>
<span class="c1">// MARK: - Relay는 Subject계열인데 끊어지지 않는다(.value로 접근시 마지막 데이터 확인가능 = stateful)</span>
<span class="k">var</span> <span class="nv">rxTodosRelay</span><span class="p">:</span> <span class="kt">BehaviorRelay</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">RxTodo</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">BehaviorRelay</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="kt">RxTodo</span><span class="o">.</span><span class="nf">getDumies</span><span class="p">())</span>
<span class="n">rxTodosRelay</span>
    <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">myTableView</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">tableView</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="kt">RxTodoCell</span><span class="o">.</span><span class="n">reuseIdentifier</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">RxTodoCell</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kt">UITableViewCell</span><span class="p">()}</span>
        <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cell</span>
    <span class="p">}</span>
    <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
</code></pre></div></div>
<p>이전 포스팅에서 아래와 같이 더미 데이터를 한 번만 방출하도록 설정하였다.  <br />
이 코드는 초기 데이터만 표시하고 변화가 될 수 없기 때문에 한계가 있다.<br />
<br /><br /><br /><br /></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// MARK: - 3초뒤 갱신</span>
<span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">asyncAfter</span><span class="p">(</span><span class="nv">deadline</span><span class="p">:</span> <span class="o">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="kt">RxTodo</span><span class="o">.</span><span class="nf">getDumies</span><span class="p">(</span><span class="nv">count</span><span class="p">:</span> <span class="mi">3</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">// MARK: - Rx스러운 3초뒤 갱신</span>
<span class="kt">Observable</span><span class="o">.</span><span class="nf">just</span><span class="p">(())</span>
    <span class="o">.</span><span class="nf">delay</span><span class="p">(</span><span class="o">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nv">scheduler</span><span class="p">:</span> <span class="kt">MainScheduler</span><span class="o">.</span><span class="n">instance</span><span class="p">)</span> <span class="c1">// Observable&lt;Void&gt;</span>
    <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="kt">RxTodo</span><span class="o">.</span><span class="nf">getDumies</span><span class="p">(</span><span class="nv">count</span><span class="p">:</span> <span class="mi">5</span><span class="p">)</span> <span class="p">}</span>                    <span class="c1">// Observable&lt;[RxTodo]&gt;</span>
    <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="nv">_</span><span class="p">:))</span>            <span class="c1">// 같은 자료형이면 클로저가 들어갈 수 있다</span>
    <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
</code></pre></div></div>
<p>기존 딜레이 코드를 Rx스럽게 변경도 된다 동일한 로직이다.<br />
<br /><br /><br /><br /></p>

<h1 id="rxdatasource">RxDataSource</h1>
<p>RxDataSource는 Relay 같은 Observable이 갱신되면 렌더링이 된다.<br />
지금 코드에서 todosRelay를 BehaviorRelay로 사용한 이유는 마지막 데이터를 알아야 CRUD를 진행할 수 있기 때문이다.<br />
<br /><br /><br /><br /></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// MARK: - 버튼 연결</span>
<span class="n">addButton</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span>
    <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="k">var</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span> <span class="c1">// .value 하면 마지막에 보낸 데이터 할 수 있음</span>
        <span class="n">currentTodos</span><span class="o">.</span><span class="nf">insert</span><span class="p">(</span><span class="kt">RxTodo</span><span class="p">(),</span> <span class="nv">at</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>       <span class="c1">// 첫번째 열에 넣겠다</span>
        <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="n">currentTodos</span><span class="p">)</span>
    <span class="p">})</span>
    <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
</code></pre></div></div>
<p>crud 기능을 위해 추가 버튼을 만들었다.   <br />
맨위에서부터 데이터를 들어가게 하기위해 insert를 사용했으나 아래에 넣고싶으면 append를 사용하면된다.<br />
<br /><br /><br /><br /></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ✅ 2. (더 유연하지만 수동 캐스팅 필요 – RxCocoa)</span>
<span class="n">rxTodosRelay</span>
    <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">myTableView</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">tableView</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="k">in</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="kt">RxTodoCell</span><span class="o">.</span><span class="n">reuseIdentifier</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">RxTodoCell</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kt">UITableViewCell</span><span class="p">()}</span>
        <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">element</span><span class="p">)</span>
        
        <span class="c1">// MARK: - 셀의 delete버튼 선택되었을 때 액션을 여기서 처리</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">deleteAction</span> <span class="o">=</span> <span class="p">{</span> <span class="n">id</span> <span class="k">in</span>
            <span class="k">let</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span>
            <span class="k">let</span> <span class="nv">filteredTodos</span> <span class="o">=</span> <span class="n">currentTodos</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">id</span> <span class="p">}</span>
            <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="n">filteredTodos</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="c1">// MARK: - 셀의 토글 클릭시 액션을 여기서 처리</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">isDoneChange</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">id</span><span class="p">,</span> <span class="n">updatedIsDone</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="k">var</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span>
            <span class="c1">// 일치하는것 찾기</span>
            <span class="k">if</span> <span class="k">let</span> <span class="nv">foundTodoIndex</span> <span class="o">=</span> <span class="n">currentTodos</span><span class="o">.</span><span class="nf">firstIndex</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">id</span> <span class="p">})</span> <span class="p">{</span>
                <span class="n">currentTodos</span><span class="p">[</span><span class="n">foundTodoIndex</span><span class="p">]</span><span class="o">.</span><span class="n">isDone</span> <span class="o">=</span> <span class="n">updatedIsDone</span>
            <span class="p">}</span>
            <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="n">currentTodos</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">cell</span>
    <span class="p">}</span>
    <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
</code></pre></div></div>
<p>커스텀 셀에서 만든 클로저 버튼 액션 내부 로직을 직접 구현해준다.  <br />
이제 두가지 문제가 있는데 다음 포스팅에서 진행하겠다.</p>
<ul>
  <li>버튼도 그냥 addTarget말고 Rx로 연결하는게 어떨까?</li>
  <li>토글시 애니메이션이 전혀 없어서 어색하게 보인다<br />
<br /><br /><br /><br /></li>
</ul>

<h1 id="전체-코드">전체 코드</h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Model</span>
<span class="kd">import</span> <span class="kt">Fakery</span>
<span class="kd">import</span> <span class="kt">UIKit</span>

<span class="c1">// MARK: - Model</span>
<span class="kd">struct</span> <span class="kt">RxTodo</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span> <span class="o">=</span> <span class="kt">UUID</span><span class="p">()</span>
    <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span>
    <span class="k">var</span> <span class="nv">isDone</span><span class="p">:</span> <span class="kt">Bool</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">,</span>
         <span class="nv">isDone</span><span class="p">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="p">??</span> <span class="s">"터이틀: </span><span class="se">\(</span><span class="n">id</span><span class="o">.</span><span class="n">uuidString</span><span class="o">.</span><span class="nf">prefix</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="se">)</span><span class="s">"</span>
        <span class="k">self</span><span class="o">.</span><span class="n">isDone</span> <span class="o">=</span> <span class="n">isDone</span>
    <span class="p">}</span>

    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">getDumies</span><span class="p">(</span><span class="nv">count</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="kt">RxTodo</span><span class="p">]</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">faker</span> <span class="o">=</span> <span class="kt">Faker</span><span class="p">(</span><span class="nv">locale</span><span class="p">:</span> <span class="s">"ko"</span><span class="p">)</span>
        <span class="k">var</span> <span class="nv">result</span><span class="p">:</span> <span class="p">[</span><span class="kt">RxTodo</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">_</span> <span class="k">in</span> <span class="mi">1</span><span class="o">...</span><span class="n">count</span> <span class="p">{</span>
            <span class="k">let</span> <span class="nv">firstName</span> <span class="o">=</span> <span class="n">faker</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nf">firstName</span><span class="p">()</span>
            <span class="k">let</span> <span class="nv">lastName</span> <span class="o">=</span> <span class="n">faker</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="nf">lastName</span><span class="p">()</span>
            <span class="k">let</span> <span class="nv">title</span> <span class="o">=</span> <span class="s">"</span><span class="se">\(</span><span class="n">lastName</span><span class="se">)</span><span class="s"> </span><span class="se">\(</span><span class="n">firstName</span><span class="se">)</span><span class="s">"</span>
            <span class="n">result</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="kt">RxTodo</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="nv">isDone</span><span class="p">:</span> <span class="kc">false</span><span class="p">))</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Cell</span>
<span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">RxSwift</span>
<span class="kd">import</span> <span class="kt">RxCocoa</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">RxTodoCell</span><span class="p">:</span> <span class="kt">UITableViewCell</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">cellData</span><span class="p">:</span> <span class="kt">RxTodo</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span>

    <span class="c1">// MARK: - Rx</span>
    <span class="k">var</span> <span class="nv">disposeBag</span> <span class="o">=</span> <span class="kt">DisposeBag</span><span class="p">()</span>
    <span class="k">var</span> <span class="nv">isDoneChange</span><span class="p">:</span> <span class="p">((</span><span class="n">_</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">,</span> <span class="n">_</span> <span class="nv">newValue</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>
    <span class="k">var</span> <span class="nv">deleteAction</span><span class="p">:</span> <span class="p">((</span><span class="n">_</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">()</span>
        <span class="n">label</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"제목"</span>
        <span class="n">label</span><span class="o">.</span><span class="n">numberOfLines</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">label</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="kt">UIFont</span><span class="o">.</span><span class="nf">systemFont</span><span class="p">(</span><span class="nv">ofSize</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="nv">weight</span><span class="p">:</span> <span class="o">.</span><span class="n">bold</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">idLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">()</span>
        <span class="n">label</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"아이디"</span>
        <span class="n">label</span><span class="o">.</span><span class="n">numberOfLines</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">label</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="kt">UIFont</span><span class="o">.</span><span class="nf">systemFont</span><span class="p">(</span><span class="nv">ofSize</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="nv">weight</span><span class="p">:</span> <span class="o">.</span><span class="n">regular</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">isDoneSwitch</span><span class="p">:</span> <span class="kt">UISwitch</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">sw</span> <span class="o">=</span> <span class="kt">UISwitch</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">sw</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">deleteButton</span><span class="p">:</span> <span class="kt">UIButton</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">btn</span> <span class="o">=</span> <span class="kt">UIButton</span><span class="p">(</span><span class="nv">type</span><span class="p">:</span> <span class="o">.</span><span class="n">system</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="nf">setTitle</span><span class="p">(</span><span class="s">"Delete"</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">normal</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">widthAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalToConstant</span><span class="p">:</span> <span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="n">btn</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">vStack</span><span class="p">:</span> <span class="kt">UIStackView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">stack</span> <span class="o">=</span> <span class="kt">UIStackView</span><span class="p">(</span><span class="nv">arrangedSubviews</span><span class="p">:</span> <span class="p">[</span><span class="n">titleLabel</span><span class="p">,</span> <span class="n">idLabel</span><span class="p">])</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="o">.</span><span class="n">vertical</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="k">return</span> <span class="n">stack</span>
    <span class="p">}()</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">hStack</span><span class="p">:</span> <span class="kt">UIStackView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">stack</span> <span class="o">=</span> <span class="kt">UIStackView</span><span class="p">(</span><span class="nv">arrangedSubviews</span><span class="p">:</span> <span class="p">[</span><span class="n">vStack</span><span class="p">,</span> <span class="n">isDoneSwitch</span><span class="p">,</span> <span class="n">deleteButton</span><span class="p">])</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="o">.</span><span class="n">horizontal</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="o">.</span><span class="n">center</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">spacing</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="k">return</span> <span class="n">stack</span>
    <span class="p">}()</span>

    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="kt">UITableViewCell</span><span class="o">.</span><span class="kt">CellStyle</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="kt">String</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">style</span><span class="p">:</span> <span class="n">style</span><span class="p">,</span> <span class="nv">reuseIdentifier</span><span class="p">:</span> <span class="n">reuseIdentifier</span><span class="p">)</span>
        <span class="nf">makeUI</span><span class="p">()</span>
        <span class="nf">constraints</span><span class="p">()</span>
        
        <span class="c1">// MARK: - 버튼 연결</span>
        <span class="n">isDoneSwitch</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="n">handleIsDone</span><span class="p">),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">valueChanged</span><span class="p">)</span>
        <span class="n">deleteButton</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="n">handleDeleteButton</span><span class="p">),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">fatalError</span><span class="p">(</span><span class="s">"init(coder:) has not been implemented"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">makeUI</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">hStack</span><span class="p">]</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">contentView</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span>
            <span class="nv">$0</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">constraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="mi">20</span><span class="p">),</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="o">-</span><span class="mi">20</span><span class="p">),</span>
            <span class="n">hStack</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">contentView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="o">-</span><span class="mi">10</span><span class="p">),</span>
        <span class="p">])</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">prepareForReuse</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">prepareForReuse</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"prepareForReuse() - cellData.id: </span><span class="se">\(</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="p">??</span> <span class="kt">UUID</span><span class="p">()</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">disposeBag</span> <span class="o">=</span> <span class="kt">DisposeBag</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">RxTodoCell</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">configure</span><span class="p">(</span><span class="n">with</span> <span class="nv">todo</span><span class="p">:</span> <span class="kt">RxTodo</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">cellData</span> <span class="o">=</span> <span class="n">todo</span>
        <span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">todo</span><span class="o">.</span><span class="n">title</span>

        <span class="k">let</span> <span class="nv">idString</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="n">todo</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">uuidString</span><span class="o">.</span><span class="nf">prefix</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
        <span class="n">idLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"ID: </span><span class="se">\(</span><span class="n">idString</span><span class="se">)</span><span class="s">"</span>
        <span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">isOn</span> <span class="o">=</span> <span class="n">todo</span><span class="o">.</span><span class="n">isDone</span>
        <span class="c1">// setRx()</span>
    <span class="p">}</span>
 
    <span class="c1">// MARK: - 디버깅용</span>
    <span class="kd">func</span> <span class="nf">configure</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
        <span class="n">idLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="s">"ID: </span><span class="se">\(</span><span class="n">id</span><span class="se">)</span><span class="s">"</span>
        <span class="n">isDoneSwitch</span><span class="o">.</span><span class="n">isOn</span> <span class="o">=</span> <span class="kc">false</span>

    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">RxTodoCell</span> <span class="p">{</span>
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">handleIsDone</span><span class="p">(</span><span class="n">_</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">UISwitch</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- id: </span><span class="se">\(</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">uuidString</span> <span class="p">??</span> <span class="s">""</span><span class="se">)</span><span class="s"> sender: </span><span class="se">\(</span><span class="n">sender</span><span class="o">.</span><span class="n">isOn</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="nf">isDoneChange</span><span class="p">?(</span><span class="n">id</span><span class="p">,</span> <span class="n">sender</span><span class="o">.</span><span class="n">isOn</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">handleDeleteButton</span><span class="p">(</span><span class="n">_</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">id</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">cellData</span><span class="p">?</span><span class="o">.</span><span class="n">id</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="nf">deleteAction</span><span class="p">?(</span><span class="n">id</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cp">#if DEBUG</span>
<span class="kd">import</span> <span class="kt">SwiftUI</span>
<span class="c1">// TodoCell 미리보기</span>
<span class="kd">struct</span> <span class="kt">RxTodoCell_Preview</span><span class="p">:</span> <span class="kt">PreviewProvider</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="k">var</span> <span class="nv">previews</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="kt">RxTodoCell</span><span class="p">()</span>
        <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"할 일 예제"</span><span class="p">,</span> <span class="nv">id</span><span class="p">:</span> <span class="mi">42</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cell</span><span class="o">.</span><span class="n">contentView</span>
            <span class="o">.</span><span class="nf">getPreview</span><span class="p">()</span>
            <span class="o">.</span><span class="nf">previewLayout</span><span class="p">(</span><span class="o">.</span><span class="nf">fixed</span><span class="p">(</span><span class="nv">width</span><span class="p">:</span> <span class="mi">350</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">100</span><span class="p">))</span>
            <span class="o">.</span><span class="nf">background</span><span class="p">(</span><span class="kt">Color</span><span class="o">.</span><span class="n">white</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">#endif</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ViewController</span>
<span class="kd">import</span> <span class="kt">UIKit</span>
<span class="kd">import</span> <span class="kt">RxSwift</span>
<span class="kd">import</span> <span class="kt">RxCocoa</span>
<span class="kd">import</span> <span class="kt">RxRelay</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">RxTodoViewController2</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>

    <span class="c1">// MARK: - 구독에 대한 찌꺼기 처리</span>
    <span class="k">var</span> <span class="nv">disposeBag</span> <span class="o">=</span>  <span class="kt">DisposeBag</span><span class="p">()</span>
    
    <span class="c1">// MARK: - Relay는 Subject계열인데 끊어지지 않는다(.value로 접근시 마지막 데이터 확인가능 = stateful)</span>
    <span class="k">var</span> <span class="nv">rxTodosRelay</span><span class="p">:</span> <span class="kt">BehaviorRelay</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">RxTodo</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">BehaviorRelay</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="kt">RxTodo</span><span class="o">.</span><span class="nf">getDumies</span><span class="p">())</span>

    <span class="c1">// MARK: - UI</span>
    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">addButton</span> <span class="o">=</span> <span class="kt">UIBarButtonItem</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"추가"</span><span class="p">,</span>
                                                 <span class="nv">style</span><span class="p">:</span> <span class="o">.</span><span class="n">plain</span><span class="p">,</span>
                                                 <span class="nv">target</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span>
                                                 <span class="nv">action</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>

    <span class="kd">private</span> <span class="kd">lazy</span> <span class="k">var</span> <span class="nv">myTableView</span><span class="p">:</span> <span class="kt">UITableView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">tv</span> <span class="o">=</span> <span class="kt">UITableView</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">tv</span>
    <span class="p">}()</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span>
        <span class="nf">makeUI</span><span class="p">()</span>
        <span class="nf">constraints</span><span class="p">()</span>
        
        <span class="c1">// MARK: - 코드기반 사용한다면</span>
        <span class="n">myTableView</span><span class="o">.</span><span class="nf">register</span><span class="p">(</span><span class="kt">RxTodoCell</span><span class="o">.</span><span class="k">self</span><span class="p">,</span> <span class="nv">forCellReuseIdentifier</span><span class="p">:</span> <span class="s">"RxTodoCell"</span><span class="p">)</span>
        
        <span class="c1">// ✅ 1. RxTodoCell을 타입으로 명시하여 바인딩하는 간결한 방식</span>
        <span class="cm">/*
         data.bind(to: myTableView.rx.items(cellIdentifier: RxTodoCell.reuseIdentifier,
                                            cellType: RxTodoCell.self)) { index, model, cell in
             cell.configure(with: model)
         }
        .disposed(by: disposeBag)
         */</span>
        
        
        <span class="c1">// ✅ 2. (더 유연하지만 수동 캐스팅 필요 – RxCocoa)</span>
        <span class="n">rxTodosRelay</span>
            <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">myTableView</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">items</span><span class="p">)</span> <span class="p">{</span> <span class="p">(</span><span class="n">tableView</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">cell</span> <span class="o">=</span> <span class="n">tableView</span><span class="o">.</span><span class="nf">dequeueReusableCell</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="kt">RxTodoCell</span><span class="o">.</span><span class="n">reuseIdentifier</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">RxTodoCell</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="kt">UITableViewCell</span><span class="p">()}</span>
                <span class="n">cell</span><span class="o">.</span><span class="nf">configure</span><span class="p">(</span><span class="nv">with</span><span class="p">:</span> <span class="n">element</span><span class="p">)</span>
                
                <span class="c1">// MARK: - 셀의 delete버튼 선택되었을 때 액션을 여기서 처리</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">deleteAction</span> <span class="o">=</span> <span class="p">{</span> <span class="n">id</span> <span class="k">in</span>
                    <span class="k">let</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span>
                    <span class="k">let</span> <span class="nv">filteredTodos</span> <span class="o">=</span> <span class="n">currentTodos</span><span class="o">.</span><span class="n">filter</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">id</span> <span class="p">}</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="n">filteredTodos</span><span class="p">)</span>
                <span class="p">}</span>
                
                <span class="c1">// MARK: - 셀의 토글 클릭시 액션을 여기서 처리</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">isDoneChange</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">id</span><span class="p">,</span> <span class="n">updatedIsDone</span> <span class="k">in</span>
                    <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                    <span class="k">var</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span>
                    <span class="c1">// 일치하는것 찾기</span>
                    <span class="k">if</span> <span class="k">let</span> <span class="nv">foundTodoIndex</span> <span class="o">=</span> <span class="n">currentTodos</span><span class="o">.</span><span class="nf">firstIndex</span><span class="p">(</span><span class="nv">where</span><span class="p">:</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">id</span> <span class="p">})</span> <span class="p">{</span>
                        <span class="n">currentTodos</span><span class="p">[</span><span class="n">foundTodoIndex</span><span class="p">]</span><span class="o">.</span><span class="n">isDone</span> <span class="o">=</span> <span class="n">updatedIsDone</span>
                    <span class="p">}</span>
                    <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="n">currentTodos</span><span class="p">)</span>
                <span class="p">}</span>
                
                <span class="k">return</span> <span class="n">cell</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
        
        
        <span class="c1">// MARK: - 3초뒤 갱신</span>
        <span class="cm">/*
        DispatchQueue.main.asyncAfter(deadline: .now() + 3) {
            self.rxTodosRelay.accept(RxTodo.getDumies(count: 3))
        }
         */</span>
        
        <span class="c1">// MARK: - Rx스러운 3초뒤 갱신</span>
        <span class="cm">/*
        Observable.just(())
            .delay(.seconds(3), scheduler: MainScheduler.instance) // Observable&lt;Void&gt;
            .map { RxTodo.getDumies(count: 5) }                    // Observable&lt;[RxTodo]&gt;
            .bind(onNext: self.rxTodosRelay.accept(_:))            // 같은 자료형이면 클로저가 들어갈 수 있다
            .disposed(by: disposeBag)
        */</span>
        
        <span class="c1">// MARK: - 버튼 연결</span>
        <span class="n">addButton</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span>
            <span class="o">.</span><span class="nf">bind</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">_</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                <span class="k">var</span> <span class="nv">currentTodos</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="n">value</span> <span class="c1">// .value 하면 마지막에 보낸 데이터 할 수 있음</span>
                <span class="n">currentTodos</span><span class="o">.</span><span class="nf">insert</span><span class="p">(</span><span class="kt">RxTodo</span><span class="p">(),</span> <span class="nv">at</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>       <span class="c1">// 첫번째 열에 넣겠다</span>
                <span class="k">self</span><span class="o">.</span><span class="n">rxTodosRelay</span><span class="o">.</span><span class="nf">accept</span><span class="p">(</span><span class="n">currentTodos</span><span class="p">)</span>
            <span class="p">})</span>
            <span class="o">.</span><span class="nf">disposed</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="n">disposeBag</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">makeUI</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">myTableView</span><span class="p">]</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span>
            <span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="nv">$0</span><span class="p">)</span>
            <span class="nv">$0</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="p">}</span>
        
        <span class="c1">// 네비게이션 버튼</span>
        <span class="n">navigationItem</span><span class="o">.</span><span class="n">rightBarButtonItems</span> <span class="o">=</span> <span class="p">[</span><span class="n">addButton</span><span class="p">]</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">constraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">safeAreaLayoutGuide</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">),</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">myTableView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">view</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span>
        <span class="p">])</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>]]></content><author><name>Dong Hyeon</name></author><category term="ReactiveX" /><category term="RxDataSource" /><summary type="html"><![CDATA[기존 코드 개선 // MARK: - 한번 그려지고 끝나기 때문에 추가/삭제같은 이벤트를 반영할 수 없다. let data = Observable&lt;[RxTodo]&gt;.just(RxTodo.getDumies()) data.bind(to: myTableView.rx.items(cellIdentifier: "RxTodoCell", cellType: RxTodoCell.self)) { index, model, cell in cell.configure(with: model) } // =&gt; BehaviorRelay를 사용하여 단발성이 아닌 변화가능한 상태를 가진 스트림을 만들어서 사용하자. // MARK: - Relay는 Subject계열인데 끊어지지 않는다(.value로 접근시 마지막 데이터 확인가능 = stateful) var rxTodosRelay: BehaviorRelay&lt;[RxTodo]&gt; = BehaviorRelay(value: RxTodo.getDumies()) rxTodosRelay .bind(to: myTableView.rx.items) { (tableView, row, element) in guard let cell = tableView.dequeueReusableCell(withIdentifier: RxTodoCell.reuseIdentifier) as? RxTodoCell else { return UITableViewCell()} cell.configure(with: element) return cell } .disposed(by: disposeBag) 이전 포스팅에서 아래와 같이 더미 데이터를 한 번만 방출하도록 설정하였다. 이 코드는 초기 데이터만 표시하고 변화가 될 수 없기 때문에 한계가 있다. // MARK: - 3초뒤 갱신 DispatchQueue.main.asyncAfter(deadline: .now() + 3) { self.rxTodosRelay.accept(RxTodo.getDumies(count: 3)) } // MARK: - Rx스러운 3초뒤 갱신 Observable.just(()) .delay(.seconds(3), scheduler: MainScheduler.instance) // Observable&lt;Void&gt; .map { RxTodo.getDumies(count: 5) } // Observable&lt;[RxTodo]&gt; .bind(onNext: self.rxTodosRelay.accept(_:)) // 같은 자료형이면 클로저가 들어갈 수 있다 .disposed(by: disposeBag) 기존 딜레이 코드를 Rx스럽게 변경도 된다 동일한 로직이다. RxDataSource RxDataSource는 Relay 같은 Observable이 갱신되면 렌더링이 된다. 지금 코드에서 todosRelay를 BehaviorRelay로 사용한 이유는 마지막 데이터를 알아야 CRUD를 진행할 수 있기 때문이다. // MARK: - 버튼 연결 addButton.rx.tap .bind(onNext: { [weak self] _ in guard let self = self else { return } var currentTodos = self.rxTodosRelay.value // .value 하면 마지막에 보낸 데이터 할 수 있음 currentTodos.insert(RxTodo(), at: 0) // 첫번째 열에 넣겠다 self.rxTodosRelay.accept(currentTodos) }) .disposed(by: disposeBag) crud 기능을 위해 추가 버튼을 만들었다. 맨위에서부터 데이터를 들어가게 하기위해 insert를 사용했으나 아래에 넣고싶으면 append를 사용하면된다. // ✅ 2. (더 유연하지만 수동 캐스팅 필요 – RxCocoa) rxTodosRelay .bind(to: myTableView.rx.items) { (tableView, row, element) in guard let cell = tableView.dequeueReusableCell(withIdentifier: RxTodoCell.reuseIdentifier) as? RxTodoCell else { return UITableViewCell()} cell.configure(with: element) // MARK: - 셀의 delete버튼 선택되었을 때 액션을 여기서 처리 cell.deleteAction = { id in let currentTodos = self.rxTodosRelay.value let filteredTodos = currentTodos.filter { $0.id != id } self.rxTodosRelay.accept(filteredTodos) } // MARK: - 셀의 토글 클릭시 액션을 여기서 처리 cell.isDoneChange = { [weak self] id, updatedIsDone in guard let self = self else { return } var currentTodos = self.rxTodosRelay.value // 일치하는것 찾기 if let foundTodoIndex = currentTodos.firstIndex(where: { $0.id == id }) { currentTodos[foundTodoIndex].isDone = updatedIsDone } self.rxTodosRelay.accept(currentTodos) } return cell } .disposed(by: disposeBag) 커스텀 셀에서 만든 클로저 버튼 액션 내부 로직을 직접 구현해준다. 이제 두가지 문제가 있는데 다음 포스팅에서 진행하겠다. 버튼도 그냥 addTarget말고 Rx로 연결하는게 어떨까? 토글시 애니메이션이 전혀 없어서 어색하게 보인다 전체 코드 // Model import Fakery import UIKit // MARK: - Model struct RxTodo { let id: UUID = UUID() let title: String var isDone: Bool init(title: String? = nil, isDone: Bool = false ) { self.title = title ?? "터이틀: \(id.uuidString.prefix(8))" self.isDone = isDone } static func getDumies(count: Int = 10) -&gt; [RxTodo] { let faker = Faker(locale: "ko") var result: [RxTodo] = [] for _ in 1...count { let firstName = faker.name.firstName() let lastName = faker.name.lastName() let title = "\(lastName) \(firstName)" result.append(RxTodo(title: title, isDone: false)) } return result } } // Cell import UIKit import RxSwift import RxCocoa final class RxTodoCell: UITableViewCell { var cellData: RxTodo? = nil // MARK: - Rx var disposeBag = DisposeBag() var isDoneChange: ((_ id: UUID, _ newValue: Bool) -&gt; Void)? = nil var deleteAction: ((_ id: UUID) -&gt; Void)? = nil private let titleLabel: UILabel = { let label = UILabel() label.text = "제목" label.numberOfLines = 1 label.font = UIFont.systemFont(ofSize: 14, weight: .bold) return label }() private let idLabel: UILabel = { let label = UILabel() label.text = "아이디" label.numberOfLines = 0 label.font = UIFont.systemFont(ofSize: 12, weight: .regular) return label }() private lazy var isDoneSwitch: UISwitch = { let sw = UISwitch() return sw }() private lazy var deleteButton: UIButton = { let btn = UIButton(type: .system) btn.setTitle("Delete", for: .normal) btn.widthAnchor.constraint(equalToConstant: 50).isActive = true return btn }() private lazy var vStack: UIStackView = { let stack = UIStackView(arrangedSubviews: [titleLabel, idLabel]) stack.axis = .vertical stack.spacing = 8 return stack }() private lazy var hStack: UIStackView = { let stack = UIStackView(arrangedSubviews: [vStack, isDoneSwitch, deleteButton]) stack.axis = .horizontal stack.alignment = .center stack.spacing = 20 return stack }() override init(style: UITableViewCell.CellStyle, reuseIdentifier: String?) { super.init(style: style, reuseIdentifier: reuseIdentifier) makeUI() constraints() // MARK: - 버튼 연결 isDoneSwitch.addTarget(self, action: #selector(handleIsDone), for: .valueChanged) deleteButton.addTarget(self, action: #selector(handleDeleteButton), for: .touchUpInside) } required init?(coder: NSCoder) { fatalError("init(coder:) has not been implemented") } private func makeUI() { [hStack].forEach { contentView.addSubview($0) $0.translatesAutoresizingMaskIntoConstraints = false } } private func constraints() { NSLayoutConstraint.activate([ hStack.topAnchor.constraint(equalTo: contentView.topAnchor, constant: 10), hStack.leadingAnchor.constraint(equalTo: contentView.leadingAnchor, constant: 20), hStack.trailingAnchor.constraint(equalTo: contentView.trailingAnchor, constant: -20), hStack.bottomAnchor.constraint(equalTo: contentView.bottomAnchor, constant: -10), ]) } override func prepareForReuse() { super.prepareForReuse() print(#fileID, #function, #line, "prepareForReuse() - cellData.id: \(cellData?.id ?? UUID())") self.disposeBag = DisposeBag() } } extension RxTodoCell { func configure(with todo: RxTodo) { self.cellData = todo titleLabel.text = todo.title let idString = String(todo.id.uuidString.prefix(10)) idLabel.text = "ID: \(idString)" isDoneSwitch.isOn = todo.isDone // setRx() } // MARK: - 디버깅용 func configure(title: String, id: Int) { titleLabel.text = title idLabel.text = "ID: \(id)" isDoneSwitch.isOn = false } } extension RxTodoCell { @objc func handleIsDone(_ sender: UISwitch) { print(#fileID, #function, #line, "- id: \(cellData?.id.uuidString ?? "") sender: \(sender.isOn)") guard let id = self.cellData?.id else { return } isDoneChange?(id, sender.isOn) } @objc func handleDeleteButton(_ sender: UIButton) { guard let id = self.cellData?.id else { return } deleteAction?(id) } } #if DEBUG import SwiftUI // TodoCell 미리보기 struct RxTodoCell_Preview: PreviewProvider { static var previews: some View { let cell = RxTodoCell() cell.configure(title: "할 일 예제", id: 42) return cell.contentView .getPreview() .previewLayout(.fixed(width: 350, height: 100)) .background(Color.white) } } #endif // ViewController import UIKit import RxSwift import RxCocoa import RxRelay final class RxTodoViewController2: UIViewController { // MARK: - 구독에 대한 찌꺼기 처리 var disposeBag = DisposeBag() // MARK: - Relay는 Subject계열인데 끊어지지 않는다(.value로 접근시 마지막 데이터 확인가능 = stateful) var rxTodosRelay: BehaviorRelay&lt;[RxTodo]&gt; = BehaviorRelay(value: RxTodo.getDumies()) // MARK: - UI private lazy var addButton = UIBarButtonItem(title: "추가", style: .plain, target: nil, action: nil) private lazy var myTableView: UITableView = { let tv = UITableView() return tv }() override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white makeUI() constraints() // MARK: - 코드기반 사용한다면 myTableView.register(RxTodoCell.self, forCellReuseIdentifier: "RxTodoCell") // ✅ 1. RxTodoCell을 타입으로 명시하여 바인딩하는 간결한 방식 /* data.bind(to: myTableView.rx.items(cellIdentifier: RxTodoCell.reuseIdentifier, cellType: RxTodoCell.self)) { index, model, cell in cell.configure(with: model) } .disposed(by: disposeBag) */ // ✅ 2. (더 유연하지만 수동 캐스팅 필요 – RxCocoa) rxTodosRelay .bind(to: myTableView.rx.items) { (tableView, row, element) in guard let cell = tableView.dequeueReusableCell(withIdentifier: RxTodoCell.reuseIdentifier) as? RxTodoCell else { return UITableViewCell()} cell.configure(with: element) // MARK: - 셀의 delete버튼 선택되었을 때 액션을 여기서 처리 cell.deleteAction = { id in let currentTodos = self.rxTodosRelay.value let filteredTodos = currentTodos.filter { $0.id != id } self.rxTodosRelay.accept(filteredTodos) } // MARK: - 셀의 토글 클릭시 액션을 여기서 처리 cell.isDoneChange = { [weak self] id, updatedIsDone in guard let self = self else { return } var currentTodos = self.rxTodosRelay.value // 일치하는것 찾기 if let foundTodoIndex = currentTodos.firstIndex(where: { $0.id == id }) { currentTodos[foundTodoIndex].isDone = updatedIsDone } self.rxTodosRelay.accept(currentTodos) } return cell } .disposed(by: disposeBag) // MARK: - 3초뒤 갱신 /* DispatchQueue.main.asyncAfter(deadline: .now() + 3) { self.rxTodosRelay.accept(RxTodo.getDumies(count: 3)) } */ // MARK: - Rx스러운 3초뒤 갱신 /* Observable.just(()) .delay(.seconds(3), scheduler: MainScheduler.instance) // Observable&lt;Void&gt; .map { RxTodo.getDumies(count: 5) } // Observable&lt;[RxTodo]&gt; .bind(onNext: self.rxTodosRelay.accept(_:)) // 같은 자료형이면 클로저가 들어갈 수 있다 .disposed(by: disposeBag) */ // MARK: - 버튼 연결 addButton.rx.tap .bind(onNext: { [weak self] _ in guard let self = self else { return } var currentTodos = self.rxTodosRelay.value // .value 하면 마지막에 보낸 데이터 할 수 있음 currentTodos.insert(RxTodo(), at: 0) // 첫번째 열에 넣겠다 self.rxTodosRelay.accept(currentTodos) }) .disposed(by: disposeBag) } private func makeUI() { [myTableView].forEach { view.addSubview($0) $0.translatesAutoresizingMaskIntoConstraints = false } // 네비게이션 버튼 navigationItem.rightBarButtonItems = [addButton] } private func constraints() { NSLayoutConstraint.activate([ myTableView.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor), myTableView.leadingAnchor.constraint(equalTo: view.leadingAnchor), myTableView.trailingAnchor.constraint(equalTo: view.trailingAnchor), myTableView.bottomAnchor.constraint(equalTo: view.bottomAnchor) ]) } }]]></summary></entry><entry><title type="html">[CustomView] 4. UIKit에서 SwiftUI뷰 불러오기</title><link href="http://localhost:4000/CustomView-customView4/" rel="alternate" type="text/html" title="[CustomView] 4. UIKit에서 SwiftUI뷰 불러오기" /><published>2025-09-11T00:00:00+00:00</published><updated>2025-09-11T00:00:00+00:00</updated><id>http://localhost:4000/%5BCustomView%5D-customView4</id><content type="html" xml:base="http://localhost:4000/CustomView-customView4/"><![CDATA[<!-- <img src="/%EC%9D%B4%EB%AF%B8%EC%A7%80%EA%B2%BD%EB%A1%9C" alt="이미지" width="30%"> -->

<h1 id="uihostingcontroller">UIHostingController</h1>

<blockquote>
  <p>A UIKit view controller that manages a SwiftUI view hierarchy. <br />
SwiftUI 뷰 계층구조를 관리하는 뷰컨트롤러이다.     <br />
<a href="https://developer.apple.com/documentation/swiftui/uihostingcontroller">공식문서</a></p>
</blockquote>]]></content><author><name>Dong Hyeon</name></author><category term="CustomView" /><summary type="html"><![CDATA[UIHostingController A UIKit view controller that manages a SwiftUI view hierarchy. SwiftUI 뷰 계층구조를 관리하는 뷰컨트롤러이다. 공식문서]]></summary></entry><entry><title type="html">[CustomView] 3. 컨테이너뷰 &amp;amp; 코드로 만들어보기</title><link href="http://localhost:4000/CustomView-customView3/" rel="alternate" type="text/html" title="[CustomView] 3. 컨테이너뷰 &amp;amp; 코드로 만들어보기" /><published>2025-09-11T00:00:00+00:00</published><updated>2025-09-11T00:00:00+00:00</updated><id>http://localhost:4000/%5BCustomView%5D-customView3</id><content type="html" xml:base="http://localhost:4000/CustomView-customView3/"><![CDATA[<!-- <img src="/%EC%9D%B4%EB%AF%B8%EC%A7%80%EA%B2%BD%EB%A1%9C" alt="이미지" width="30%"> -->

<h1 id="containerview">ContainerView</h1>
<p>컨테이너뷰는 뷰컨트롤러를 화면에 넣은 것이다.  <br />
이번에는 코드기반으로 구현을 해보자.<br />
<a href="https://developer.apple.com/documentation/uikit/creating-a-custom-container-view-controller">공식문서</a><br />
<br /><br /><br /><br /></p>

<h1 id="코드로-구현하기">코드로 구현하기</h1>
<p><img src="/assets/img/2025-09-11-CustomView%5D-customView3/image-20250911144836289.png" alt="이미지" width="60%" /> <br />
이전 포스팅에서 사용한 스토리보드에 추가적으로 민트색 UIView를 추가하였다.    <br />
민트색을 지정하고, 상단 회색 UIView로 드래그하여 leading, trailing, height,vertical spacing을 설정하였다.</p>

<pre><code class="language-sswift">import UIKit

final class CodeParentViewController: UIViewController {
    
    @IBOutlet weak var mintChildContainerView: UIView!
    
    override func viewDidLoad() {
        super.viewDidLoad()
        view.backgroundColor = .white
        print(#fileID, #function, #line, "- ")
        configureChildContaianerView()
    }
    
    override func prepare(for segue: UIStoryboardSegue, sender: Any?) {
   
    }
    
    private func configureChildContaianerView() {
        let storyboard = UIStoryboard(name: "CodeContainer", bundle: .main)
        
        // MARK: - ChildVC라는 이름을 가진 녀석의 타입이 ChildVC라면 가져와러
        if let childVC = storyboard.instantiateViewController(identifier: "CodeChildViewController")
            as? CodeChildViewController {
            
            // MARK: - 이벤트 추가 가능(스토리보드 방식과 동일)
            childVC.placeHolder = "테스트"
            childVC.titleText = "코드로 만들었습니다."
            childVC.onBtnAClicked = {
                print(#fileID, #function, #line, "- 버튼 A 클릭")
            }
            
            childVC.onBtnBClicked = { input in
                print(#fileID, #function, #line, "- 버튼 B 클릭: \(input)")
            }
            childVC.onUserInputChanged = { input in
                print(#fileID, #function, #line, "- 입력됨: \(input)")
            }
            
            addChild(childVC)             // 뷰컨 자식으로 넣기
            view.addSubview(childVC.view) // 내가 가진 뷰에 뷰를 추가(뷰끼리 넣어주기)
            
            // MARK: - AutoLayout
            childVC.view.translatesAutoresizingMaskIntoConstraints = false
            let childVCConstraints = [
                childVC.view.topAnchor.constraint(equalTo: self.mintChildContainerView.topAnchor),
                childVC.view.bottomAnchor.constraint(equalTo: self.mintChildContainerView.bottomAnchor),
                childVC.view.leadingAnchor.constraint(equalTo: self.mintChildContainerView.leadingAnchor),
                childVC.view.trailingAnchor.constraint(equalTo: self.mintChildContainerView.trailingAnchor),
            ]
            
                                                                   
            NSLayoutConstraint.activate(childVCConstraints )
            
            // 자식뷰가 들어왔다고 알려주기
            childVC.didMove(toParent: self)
        }
    }
    
    /*
    private func configureChildContaianerViewWidhCreatorBlock() {
        let storyboard = UIStoryboard(name: "CodeContainer", bundle: .main)
        
        // MARK: - ChildVC라는 이름을 가진 녀석의 타입이 ChildVC라면 가져와러
        if let childVC = storyboard.instantiateViewController(identifier: "CodeChildViewController", creator: { coder in
            return CodeChildViewController(coder: coder,
                                           titleText: "테스트",
                                           placeholder: "테스트2",
                                           onBtnAClicked: self.handleAtnAClicked,
                                           onBtnBClicked: self.handleBtnAClicked,
                                           onUserInputChanged: self.handleInputFromChildVC
            )
        }) as? CodeChildViewController {
            
            // MARK: - 이벤트 추가 가능(스토리보드 방식과 동일)
            childVC.placeHolder = "테스트"
            childVC.titleText = "코드로 만들었습니다."
            childVC.onBtnAClicked = {
                print(#fileID, #function, #line, "- 버튼 A 클릭")
            }
            
            childVC.onBtnBClicked = { input in
                print(#fileID, #function, #line, "- 버튼 B 클릭: \(input)")
            }
            childVC.onUserInputChanged = { input in
                print(#fileID, #function, #line, "- 입력됨: \(input)")
            }
            
            addChild(childVC)             // 뷰컨 자식으로 넣기
            view.addSubview(childVC.view) // 내가 가진 뷰에 뷰를 추가(뷰끼리 넣어주기)
            
            // MARK: - AutoLayout
            childVC.view.translatesAutoresizingMaskIntoConstraints = false
            let childVCConstraints = [
                childVC.view.topAnchor.constraint(equalTo: self.mintChildContainerView.topAnchor),
                childVC.view.bottomAnchor.constraint(equalTo: self.mintChildContainerView.bottomAnchor),
                childVC.view.leadingAnchor.constraint(equalTo: self.mintChildContainerView.leadingAnchor),
                childVC.view.trailingAnchor.constraint(equalTo: self.mintChildContainerView.trailingAnchor),
            ]
            
                                                                   
            NSLayoutConstraint.activate(childVCConstraints )
            
            // 자식뷰가 들어왔다고 알려주기
            childVC.didMove(toParent: self)
        }
    }
     */
    
    
    private func handleAtnAClicked() {
        
    }
    
    private func handleBtnAClicked(_ input: String) {
        
    }
    
    private func handleInputFromChildVC(_ input: String) {
        
    }
}
</code></pre>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">CodeChildViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span><span class="o">!</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">inputTextField</span><span class="p">:</span> <span class="kt">UITextField</span><span class="o">!</span>
    
    <span class="k">var</span> <span class="nv">onBtnAClicked</span><span class="p">:</span> <span class="p">(()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>            <span class="c1">// A버튼 클릭 이벤트</span>
    <span class="k">var</span> <span class="nv">onBtnBClicked</span><span class="p">:</span> <span class="p">((</span><span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>      <span class="c1">// B버튼 클릭 이벤트</span>
    <span class="k">var</span> <span class="nv">onUserInputChanged</span><span class="p">:</span> <span class="p">((</span><span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span> <span class="c1">// 글자 입력시 이벤트</span>
    
    <span class="c1">// @IBInspectable: Interface Builder에서 속성을 넣어주는 역할</span>
    <span class="c1">// 프로퍼티 옵저버</span>
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">titleText</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">titleText</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">?</span> <span class="s">"글자를 입력해주세요"</span> <span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">var</span> <span class="nv">bgColor</span><span class="p">:</span> <span class="kt">UIColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">systemYellow</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">bgColor</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - creator를 이용한 생성자 주입방식</span>
<span class="c1">//    init?(coder: NSCoder,</span>
<span class="c1">//          titleText: String,</span>
<span class="c1">//          placeholder: String,</span>
<span class="c1">//          onBtnAClicked: (() -&gt; Void)? = nil,</span>
<span class="c1">//          onBtnBClicked: ((String) -&gt; Void)? = nil,</span>
<span class="c1">//          onUserInputChanged: ((String) -&gt; Void)? = nil</span>
<span class="c1">//    ) {</span>
<span class="c1">//        self.titleText = titleText</span>
<span class="c1">//        self.placeHolder = placeholder</span>
<span class="c1">//        self.onBtnAClicked = onBtnAClicked</span>
<span class="c1">//        self.onBtnBClicked = onBtnBClicked</span>
<span class="c1">//        self.onUserInputChanged = onUserInputChanged</span>
<span class="c1">//        super.init(coder: coder)</span>
<span class="c1">//    }</span>
<span class="c1">//    </span>
<span class="c1">//    required init?(coder: NSCoder) {</span>
<span class="c1">//        fatalError("init(coder:) has not been implemented")</span>
<span class="c1">//    }</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        
        <span class="n">inputTextField</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onUserInputChanged</span><span class="p">(</span><span class="nv">_</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">editingChanged</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 버튼 이벤트</span>
    <span class="c1">/// 스토리보드에서 태그 설정해두면 이 메서드 하나로 여러 버튼 연결해서 분기 가능</span>
    <span class="kd">@IBAction</span> <span class="kd">func</span> <span class="nf">onBtcClicked</span><span class="p">(</span><span class="n">_</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">sender</span><span class="o">.</span><span class="n">tag</span> <span class="p">{</span>
        <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"버튼 A 클릭"</span><span class="p">)</span>
            <span class="nf">onBtnAClicked</span><span class="p">?()</span>
        <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"버튼 B 클릭"</span><span class="p">)</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">input</span> <span class="o">=</span> <span class="n">inputTextField</span><span class="o">.</span><span class="n">text</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="nf">onBtnBClicked</span><span class="p">?(</span><span class="n">input</span><span class="p">)</span>
        <span class="k">default</span><span class="p">:</span> <span class="k">break</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 텍스트필드 입력시 이벤트</span>
    <span class="kd">@objc</span> <span class="kd">private</span> <span class="kd">func</span> <span class="nf">onUserInputChanged</span><span class="p">(</span><span class="n">_</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">UITextField</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- sender.text: </span><span class="se">\(</span><span class="n">sender</span><span class="o">.</span><span class="n">text</span><span class="o">!</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">onUserInputChanged</span><span class="p">?(</span><span class="n">sender</span><span class="o">.</span><span class="n">text</span> <span class="p">??</span> <span class="s">""</span><span class="p">)</span>
    <span class="p">}</span>
    
<span class="p">}</span>
</code></pre></div></div>

<h1 id="reference">Reference</h1>
<ul>
  <li><a href="https://developer.apple.com/documentation/uikit/creating-a-custom-container-view-controller">공식문서</a></li>
</ul>]]></content><author><name>Dong Hyeon</name></author><category term="CustomView" /><summary type="html"><![CDATA[ContainerView 컨테이너뷰는 뷰컨트롤러를 화면에 넣은 것이다. 이번에는 코드기반으로 구현을 해보자. 공식문서 코드로 구현하기 이전 포스팅에서 사용한 스토리보드에 추가적으로 민트색 UIView를 추가하였다. 민트색을 지정하고, 상단 회색 UIView로 드래그하여 leading, trailing, height,vertical spacing을 설정하였다. import UIKit final class CodeParentViewController: UIViewController { @IBOutlet weak var mintChildContainerView: UIView! override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white print(#fileID, #function, #line, "- ") configureChildContaianerView() } override func prepare(for segue: UIStoryboardSegue, sender: Any?) { } private func configureChildContaianerView() { let storyboard = UIStoryboard(name: "CodeContainer", bundle: .main) // MARK: - ChildVC라는 이름을 가진 녀석의 타입이 ChildVC라면 가져와러 if let childVC = storyboard.instantiateViewController(identifier: "CodeChildViewController") as? CodeChildViewController { // MARK: - 이벤트 추가 가능(스토리보드 방식과 동일) childVC.placeHolder = "테스트" childVC.titleText = "코드로 만들었습니다." childVC.onBtnAClicked = { print(#fileID, #function, #line, "- 버튼 A 클릭") } childVC.onBtnBClicked = { input in print(#fileID, #function, #line, "- 버튼 B 클릭: \(input)") } childVC.onUserInputChanged = { input in print(#fileID, #function, #line, "- 입력됨: \(input)") } addChild(childVC) // 뷰컨 자식으로 넣기 view.addSubview(childVC.view) // 내가 가진 뷰에 뷰를 추가(뷰끼리 넣어주기) // MARK: - AutoLayout childVC.view.translatesAutoresizingMaskIntoConstraints = false let childVCConstraints = [ childVC.view.topAnchor.constraint(equalTo: self.mintChildContainerView.topAnchor), childVC.view.bottomAnchor.constraint(equalTo: self.mintChildContainerView.bottomAnchor), childVC.view.leadingAnchor.constraint(equalTo: self.mintChildContainerView.leadingAnchor), childVC.view.trailingAnchor.constraint(equalTo: self.mintChildContainerView.trailingAnchor), ] NSLayoutConstraint.activate(childVCConstraints ) // 자식뷰가 들어왔다고 알려주기 childVC.didMove(toParent: self) } } /* private func configureChildContaianerViewWidhCreatorBlock() { let storyboard = UIStoryboard(name: "CodeContainer", bundle: .main) // MARK: - ChildVC라는 이름을 가진 녀석의 타입이 ChildVC라면 가져와러 if let childVC = storyboard.instantiateViewController(identifier: "CodeChildViewController", creator: { coder in return CodeChildViewController(coder: coder, titleText: "테스트", placeholder: "테스트2", onBtnAClicked: self.handleAtnAClicked, onBtnBClicked: self.handleBtnAClicked, onUserInputChanged: self.handleInputFromChildVC ) }) as? CodeChildViewController { // MARK: - 이벤트 추가 가능(스토리보드 방식과 동일) childVC.placeHolder = "테스트" childVC.titleText = "코드로 만들었습니다." childVC.onBtnAClicked = { print(#fileID, #function, #line, "- 버튼 A 클릭") } childVC.onBtnBClicked = { input in print(#fileID, #function, #line, "- 버튼 B 클릭: \(input)") } childVC.onUserInputChanged = { input in print(#fileID, #function, #line, "- 입력됨: \(input)") } addChild(childVC) // 뷰컨 자식으로 넣기 view.addSubview(childVC.view) // 내가 가진 뷰에 뷰를 추가(뷰끼리 넣어주기) // MARK: - AutoLayout childVC.view.translatesAutoresizingMaskIntoConstraints = false let childVCConstraints = [ childVC.view.topAnchor.constraint(equalTo: self.mintChildContainerView.topAnchor), childVC.view.bottomAnchor.constraint(equalTo: self.mintChildContainerView.bottomAnchor), childVC.view.leadingAnchor.constraint(equalTo: self.mintChildContainerView.leadingAnchor), childVC.view.trailingAnchor.constraint(equalTo: self.mintChildContainerView.trailingAnchor), ] NSLayoutConstraint.activate(childVCConstraints ) // 자식뷰가 들어왔다고 알려주기 childVC.didMove(toParent: self) } } */ private func handleAtnAClicked() { } private func handleBtnAClicked(_ input: String) { } private func handleInputFromChildVC(_ input: String) { } } import UIKit final class CodeChildViewController: UIViewController { @IBOutlet weak var titleLabel: UILabel! @IBOutlet weak var inputTextField: UITextField! var onBtnAClicked: (() -&gt; Void)? = nil // A버튼 클릭 이벤트 var onBtnBClicked: ((String) -&gt; Void)? = nil // B버튼 클릭 이벤트 var onUserInputChanged: ((String) -&gt; Void)? = nil // 글자 입력시 이벤트 // @IBInspectable: Interface Builder에서 속성을 넣어주는 역할 // 프로퍼티 옵저버 @IBInspectable var titleText: String = "" { didSet { DispatchQueue.main.async { self.titleLabel.text = self.titleText } } } @IBInspectable var placeHolder: String = "" { didSet { DispatchQueue.main.async { self.inputTextField.placeholder = self.placeHolder.isEmpty ? "글자를 입력해주세요" : self.placeHolder } } } var bgColor: UIColor = .systemYellow { didSet { DispatchQueue.main.async { self.view.backgroundColor = self.bgColor } } } // MARK: - creator를 이용한 생성자 주입방식 // init?(coder: NSCoder, // titleText: String, // placeholder: String, // onBtnAClicked: (() -&gt; Void)? = nil, // onBtnBClicked: ((String) -&gt; Void)? = nil, // onUserInputChanged: ((String) -&gt; Void)? = nil // ) { // self.titleText = titleText // self.placeHolder = placeholder // self.onBtnAClicked = onBtnAClicked // self.onBtnBClicked = onBtnBClicked // self.onUserInputChanged = onUserInputChanged // super.init(coder: coder) // } // // required init?(coder: NSCoder) { // fatalError("init(coder:) has not been implemented") // } override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white print(#fileID, #function, #line, "- ") inputTextField.addTarget(self, action: #selector(onUserInputChanged(_:)), for: .editingChanged) } // MARK: - 버튼 이벤트 /// 스토리보드에서 태그 설정해두면 이 메서드 하나로 여러 버튼 연결해서 분기 가능 @IBAction func onBtcClicked(_ sender: UIButton) { switch sender.tag { case 1: print("버튼 A 클릭") onBtnAClicked?() case 2: print("버튼 B 클릭") guard let input = inputTextField.text else { return } onBtnBClicked?(input) default: break } } // MARK: - 텍스트필드 입력시 이벤트 @objc private func onUserInputChanged(_ sender: UITextField) { print(#fileID, #function, #line, "- sender.text: \(sender.text!)") self.onUserInputChanged?(sender.text ?? "") } } Reference 공식문서]]></summary></entry><entry><title type="html">[CustomView] 2. 컨테이너뷰 &amp;amp; 스토리보드로 만들어보기</title><link href="http://localhost:4000/CustomView-customView2/" rel="alternate" type="text/html" title="[CustomView] 2. 컨테이너뷰 &amp;amp; 스토리보드로 만들어보기" /><published>2025-09-09T00:00:00+00:00</published><updated>2025-09-09T00:00:00+00:00</updated><id>http://localhost:4000/%5BCustomView%5D-customView2</id><content type="html" xml:base="http://localhost:4000/CustomView-customView2/"><![CDATA[<!-- <img src="/%EC%9D%B4%EB%AF%B8%EC%A7%80%EA%B2%BD%EB%A1%9C" alt="이미지" width="30%"> -->

<h1 id="containerview">ContainerView</h1>

<p><img src="https://docs-assets.developer.apple.com/published/31b57b164fcd77f6c82549528d86339e/media-3375406%402x.png" alt="이미지" width="60%" /><br />
<a href="https://developer.apple.com/documentation/uikit/creating-a-custom-container-view-controller">공식문서</a><br />
UIView안에 ViewController가 들어간 것을 컨테이너뷰라고한다. 대표적인 예시가 NavigationController, TabBarController, PageViewController이다.   <br />
컨테이너뷰는 다른 컨트롤러를 담아서 사용할 수 있다.<br />
<br /><br /><br /><br /></p>

<p><img src="https://docs-assets.developer.apple.com/published/e1ea2e4e04857d762d37bd948d9fb131/media-3376047%402x.png" alt="이미지" width="60%" /><br />
초록색 View에 ViewController가 들어있는 것이다. 문서에서 컨테이너 뷰 자체에 하위 뷰를 추가하지 말고 뷰 컨트롤러의 뷰에 추가하라고 한다. 세그웨이 방식으로 연결되어있기 때문에 prepare같은 델리게이트 함수도 사용할 수 있다.<br />
<br /><br /><br /><br /></p>

<h1 id="스토리보드로-개발하기">스토리보드로 개발하기</h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">ParentViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">ChildViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>우선 스토리보드로 컨테이너뷰 만들기를 진행해보자. Container.storyboard, ParentVC, ChildVC 각각 만들어주자.<br />
<br /><br /><br /><br /></p>

<p><img src="/assets/img/2025-09-09-%5BCustomView%5D-customView2/image-20250910232505762.png" alt="이미지" width="60%" /> <br />
container.stoayboard에서 cmd + shift + l에서 container 검색해서 나오는 것을 화면에 두고, 오토레이아웃(leading, top, center horizontal, height) 설정을 해준다. 그러면 사진과 같은 화면이 생긴다. 화면의 일부분을 viewController로 사용하고 싶을 때 주로 사용한다.<br />
<br /><br /><br /><br /></p>

<p><img src="/assets/img/2025-09-09-%5BCustomView%5D-customView2/image-20250910233556584.png" alt="이미지" width="60%" /> <br />
기존 만들어둔 노란색 뷰를 작은 VireController로 드래그하여 가져오고, 상하좌우 공백 없이 레이아웃을 지정해준다.  Stack의 Distribution을 Fill Equally로 해주었다. 그리고 view, stackView 둘다 size inspector에서 Safe Area Relative Margins를 체크 해제하였다. 그리고 스택뷰의 size inspector에서 Layout Margins를 Language Directional을 클릭하여 마진을 각각 10씩 전부 지정하였다. 실행을 위해 큰화면은 ParentVC, 작은화면은 ChildVC를 연결하고, Container.storyboard에서는 Identifier를 ParentVC로 설정해준다. <br />
<br /><br /><br /><br /></p>

<p><img src="/assets/img/2025-09-09-%5BCustomView%5D-customView2/image-20250911000548093.png" alt="이미지" width="100%" /> <br />
이제 버튼 이벤트 관련 로직을 추가해보자. Container 스토리보드에서 label, textField, 버튼을 드래그해서 ChildVC로 드래그하여 변수로 연결해준다. 버튼은 그냥 액션으로 하나의 액션으로 받되 태그로 구분하도록 하자. 클로저로 이벤트를 전달하는 방식의 장점은 VC에서는 버튼이 눌렸다는 사실만 알리고 어떤 동작을 할지는 외부에서 결정할 수 있다. 즉 뷰 컨트롤러 자체가 다른 계층(VM, ParentVC)에 덜 의존적으로 됨으로 재사용성이 증가하게 된다. 또한 Delegate 패턴처럼 프로토콜 정의, 채택, 함수 구현과정이 필요 없고 단순히 클로저 하나로 콜백을 전달할 수 있어서 코드가 간결하다. 또한 상황에 따라 다른 행동을 쉽게 지정할 수 있다. 마지막으로 클로저는 캡처방식을 잘쓰면 delegate보다 가볍게 관리되고 불필요한 Retain Cycle도 직접 관리할 수 있다. 하지만 이벤트가 많아지면 코드가 복잡해질 수 있어서 단순 이벤트는 클로저, 다수 이벤트나 복잡한 상호작용은 Delegate 패턴을 사용하는 것이 좋다. <br />
현재 코드에서 @IBInspectable을 사용했기 때문에 Interface Builder에서 title, placeholder를 변경할 수 있다.<br />
<br /><br /><br /><br /></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">prepare</span><span class="p">(</span><span class="k">for</span> <span class="nv">segue</span><span class="p">:</span> <span class="kt">UIStoryboardSegue</span><span class="p">,</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">Any</span><span class="p">?)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">childVC</span> <span class="o">=</span> <span class="n">segue</span><span class="o">.</span><span class="n">destination</span> <span class="k">as?</span> <span class="kt">ChildViewController</span> <span class="p">{</span>
        <span class="n">childVC</span><span class="o">.</span><span class="n">onUserInputChanged</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">input</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"입력을 할때 이벤트 발생: -</span><span class="se">\(</span><span class="n">input</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="n">childVC</span><span class="o">.</span><span class="n">onBtnAClicked</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"버튼 A 이벤트 발생:"</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="n">childVC</span><span class="o">.</span><span class="n">onBtnBClicked</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">input</span> <span class="k">in</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"버튼 B 이벤트 발생: -</span><span class="se">\(</span><span class="n">input</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>이것도 Embed Segue라서 prepare함수가 동일하게 타는것을 알 수 있다. 도착하는 뷰컨트롤러가 ChildVC이므로 분기처리가 가능하다.</p>

<h1 id="전체코드">전체코드</h1>
<p><img src="/assets/img/2025-09-09-%5BCustomView%5D-customView2/image-20250911003024668.png" alt="이미지" width="50%" /></p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">ParentViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">prepare</span><span class="p">(</span><span class="k">for</span> <span class="nv">segue</span><span class="p">:</span> <span class="kt">UIStoryboardSegue</span><span class="p">,</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">Any</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">childVC</span> <span class="o">=</span> <span class="n">segue</span><span class="o">.</span><span class="n">destination</span> <span class="k">as?</span> <span class="kt">ChildViewController</span> <span class="p">{</span>
            
            <span class="n">childVC</span><span class="o">.</span><span class="n">bgColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">systemMint</span>
            <span class="n">childVC</span><span class="o">.</span><span class="n">onUserInputChanged</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">input</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"입력을 할때 이벤트 발생: - </span><span class="se">\(</span><span class="n">input</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="n">childVC</span><span class="o">.</span><span class="n">onBtnAClicked</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"버튼 A 이벤트 발생:"</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="n">childVC</span><span class="o">.</span><span class="n">onBtnBClicked</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span> <span class="n">input</span> <span class="k">in</span>
                <span class="k">guard</span> <span class="k">let</span> <span class="nv">self</span> <span class="o">=</span> <span class="k">self</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                <span class="nf">print</span><span class="p">(</span><span class="s">"버튼 B 이벤트 발생: -</span><span class="se">\(</span><span class="n">input</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">ChildViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    
    <span class="c1">// MARK: - 스토리보드 연결</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span><span class="o">!</span>
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">inputTextField</span><span class="p">:</span> <span class="kt">UITextField</span><span class="o">!</span>
    
    <span class="c1">// MARK: - 버튼 이벤트 클로저로 구현</span>
    <span class="k">var</span> <span class="nv">onBtnAClicked</span><span class="p">:</span> <span class="p">(()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>              <span class="c1">/// A 버튼 이벤트</span>
    <span class="k">var</span> <span class="nv">onBtnBClicked</span><span class="p">:</span> <span class="p">((</span><span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>        <span class="c1">/// A 버튼 이벤트</span>
    <span class="k">var</span> <span class="nv">onUserInputChanged</span><span class="p">:</span> <span class="p">((</span><span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>   <span class="c1">/// 입력 이벤트</span>
    
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">titleText</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">titleText</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">?</span> <span class="s">"글자를 입력해주세요!"</span> <span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">var</span> <span class="nv">bgColor</span><span class="p">:</span> <span class="kt">UIColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">systemYellow</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">bgColor</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">view</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">white</span>
        
        <span class="c1">// MARK: - AddTarget</span>
        <span class="n">inputTextField</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onUserInputChanged</span><span class="p">(</span><span class="nv">_</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">editingChanged</span><span class="p">)</span>
    <span class="p">}</span>
     
    <span class="kd">@IBAction</span> <span class="kd">func</span> <span class="nf">onBtnClicked</span><span class="p">(</span><span class="n">_</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">switch</span> <span class="n">sender</span><span class="o">.</span><span class="n">tag</span> <span class="p">{</span>
        <span class="k">case</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"버튼 A 클릭"</span><span class="p">)</span>
            <span class="nf">onBtnAClicked</span><span class="p">?()</span>
        <span class="k">case</span> <span class="mi">2</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"버튼 B 클릭"</span><span class="p">)</span>
            <span class="k">guard</span> <span class="k">let</span> <span class="nv">input</span> <span class="o">=</span> <span class="n">inputTextField</span><span class="o">.</span><span class="n">text</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
            <span class="nf">onBtnBClicked</span><span class="p">?(</span><span class="n">input</span><span class="p">)</span>
        <span class="k">default</span><span class="p">:</span> <span class="k">break</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">ChildViewController</span> <span class="p">{</span>
    <span class="kd">@objc</span> <span class="kd">private</span> <span class="kd">func</span> <span class="nf">onUserInputChanged</span><span class="p">(</span><span class="n">_</span> <span class="nv">sender</span><span class="p">:</span> <span class="kt">UITextField</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- </span><span class="se">\(</span><span class="n">sender</span><span class="o">.</span><span class="n">text</span> <span class="p">??</span> <span class="s">""</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">input</span> <span class="o">=</span> <span class="n">inputTextField</span><span class="o">.</span><span class="n">text</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="nf">onUserInputChanged</span><span class="p">?(</span><span class="n">input</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span> 
</code></pre></div></div>

<h1 id="reference">Reference</h1>
<ul>
  <li><a href="https://developer.apple.com/documentation/uikit/creating-a-custom-container-view-controller">공식문서</a></li>
</ul>]]></content><author><name>Dong Hyeon</name></author><category term="CustomView" /><summary type="html"><![CDATA[ContainerView 공식문서 UIView안에 ViewController가 들어간 것을 컨테이너뷰라고한다. 대표적인 예시가 NavigationController, TabBarController, PageViewController이다. 컨테이너뷰는 다른 컨트롤러를 담아서 사용할 수 있다. 초록색 View에 ViewController가 들어있는 것이다. 문서에서 컨테이너 뷰 자체에 하위 뷰를 추가하지 말고 뷰 컨트롤러의 뷰에 추가하라고 한다. 세그웨이 방식으로 연결되어있기 때문에 prepare같은 델리게이트 함수도 사용할 수 있다. 스토리보드로 개발하기 final class ParentViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white } } final class ChildViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white } } 우선 스토리보드로 컨테이너뷰 만들기를 진행해보자. Container.storyboard, ParentVC, ChildVC 각각 만들어주자. container.stoayboard에서 cmd + shift + l에서 container 검색해서 나오는 것을 화면에 두고, 오토레이아웃(leading, top, center horizontal, height) 설정을 해준다. 그러면 사진과 같은 화면이 생긴다. 화면의 일부분을 viewController로 사용하고 싶을 때 주로 사용한다. 기존 만들어둔 노란색 뷰를 작은 VireController로 드래그하여 가져오고, 상하좌우 공백 없이 레이아웃을 지정해준다. Stack의 Distribution을 Fill Equally로 해주었다. 그리고 view, stackView 둘다 size inspector에서 Safe Area Relative Margins를 체크 해제하였다. 그리고 스택뷰의 size inspector에서 Layout Margins를 Language Directional을 클릭하여 마진을 각각 10씩 전부 지정하였다. 실행을 위해 큰화면은 ParentVC, 작은화면은 ChildVC를 연결하고, Container.storyboard에서는 Identifier를 ParentVC로 설정해준다. 이제 버튼 이벤트 관련 로직을 추가해보자. Container 스토리보드에서 label, textField, 버튼을 드래그해서 ChildVC로 드래그하여 변수로 연결해준다. 버튼은 그냥 액션으로 하나의 액션으로 받되 태그로 구분하도록 하자. 클로저로 이벤트를 전달하는 방식의 장점은 VC에서는 버튼이 눌렸다는 사실만 알리고 어떤 동작을 할지는 외부에서 결정할 수 있다. 즉 뷰 컨트롤러 자체가 다른 계층(VM, ParentVC)에 덜 의존적으로 됨으로 재사용성이 증가하게 된다. 또한 Delegate 패턴처럼 프로토콜 정의, 채택, 함수 구현과정이 필요 없고 단순히 클로저 하나로 콜백을 전달할 수 있어서 코드가 간결하다. 또한 상황에 따라 다른 행동을 쉽게 지정할 수 있다. 마지막으로 클로저는 캡처방식을 잘쓰면 delegate보다 가볍게 관리되고 불필요한 Retain Cycle도 직접 관리할 수 있다. 하지만 이벤트가 많아지면 코드가 복잡해질 수 있어서 단순 이벤트는 클로저, 다수 이벤트나 복잡한 상호작용은 Delegate 패턴을 사용하는 것이 좋다. 현재 코드에서 @IBInspectable을 사용했기 때문에 Interface Builder에서 title, placeholder를 변경할 수 있다. override func prepare(for segue: UIStoryboardSegue, sender: Any?) { if let childVC = segue.destination as? ChildViewController { childVC.onUserInputChanged = { [weak self] input in guard let self = self else { return } print("입력을 할때 이벤트 발생: -\(input)") } childVC.onBtnAClicked = { [weak self] in guard let self = self else { return } print("버튼 A 이벤트 발생:") } childVC.onBtnBClicked = { [weak self] input in guard let self = self else { return } print("버튼 B 이벤트 발생: -\(input)") } } } 이것도 Embed Segue라서 prepare함수가 동일하게 타는것을 알 수 있다. 도착하는 뷰컨트롤러가 ChildVC이므로 분기처리가 가능하다. 전체코드 import UIKit final class ParentViewController: UIViewController { override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white } override func prepare(for segue: UIStoryboardSegue, sender: Any?) { if let childVC = segue.destination as? ChildViewController { childVC.bgColor = .systemMint childVC.onUserInputChanged = { [weak self] input in guard let self = self else { return } print("입력을 할때 이벤트 발생: - \(input)") } childVC.onBtnAClicked = { [weak self] in guard let self = self else { return } print("버튼 A 이벤트 발생:") } childVC.onBtnBClicked = { [weak self] input in guard let self = self else { return } print("버튼 B 이벤트 발생: -\(input)") } } } } import UIKit final class ChildViewController: UIViewController { // MARK: - 스토리보드 연결 @IBOutlet weak var titleLabel: UILabel! @IBOutlet weak var inputTextField: UITextField! // MARK: - 버튼 이벤트 클로저로 구현 var onBtnAClicked: (() -&gt; Void)? = nil /// A 버튼 이벤트 var onBtnBClicked: ((String) -&gt; Void)? = nil /// A 버튼 이벤트 var onUserInputChanged: ((String) -&gt; Void)? = nil /// 입력 이벤트 @IBInspectable var titleText: String = "" { didSet { DispatchQueue.main.async { self.titleLabel.text = self.titleText } } } @IBInspectable var placeHolder: String = "" { didSet { DispatchQueue.main.async { self.inputTextField.placeholder = self.placeHolder.isEmpty ? "글자를 입력해주세요!" : self.placeHolder } } } var bgColor: UIColor = .systemYellow { didSet { DispatchQueue.main.async { self.view.backgroundColor = self.bgColor } } } override func viewDidLoad() { super.viewDidLoad() view.backgroundColor = .white // MARK: - AddTarget inputTextField.addTarget(self, action: #selector(onUserInputChanged(_:)), for: .editingChanged) } @IBAction func onBtnClicked(_ sender: UIButton) { switch sender.tag { case 1: print("버튼 A 클릭") onBtnAClicked?() case 2: print("버튼 B 클릭") guard let input = inputTextField.text else { return } onBtnBClicked?(input) default: break } } } extension ChildViewController { @objc private func onUserInputChanged(_ sender: UITextField) { print(#fileID, #function, #line, "- \(sender.text ?? "")") guard let input = inputTextField.text else { return } onUserInputChanged?(input) } } Reference 공식문서]]></summary></entry><entry><title type="html">[CustomView] 1. Xib파일로 스토리보드기반, 코드기반 커스텀뷰 만들기</title><link href="http://localhost:4000/CustomView-customView1/" rel="alternate" type="text/html" title="[CustomView] 1. Xib파일로 스토리보드기반, 코드기반 커스텀뷰 만들기" /><published>2025-09-04T00:00:00+00:00</published><updated>2025-09-04T00:00:00+00:00</updated><id>http://localhost:4000/%5BCustomView%5D-customView1</id><content type="html" xml:base="http://localhost:4000/CustomView-customView1/"><![CDATA[<!-- <img src="/%EC%9D%B4%EB%AF%B8%EC%A7%80%EA%B2%BD%EB%A1%9C" alt="이미지" width="30%"> -->

<h2 id="커스텀뷰-만들기">커스텀뷰 만들기</h2>
<p><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904153909426.png" alt="이미지" width="30%" /><br />
우선 Storyboard에서 사진 처럼 UI를 만든다. Button을 hstack으로 묶고, label, textfield, hstack을 vstack으로 묶는다. 그리고 view를 embed하고 색성을 주고, vstack을 view로 드래그하여 상하좌우 전부 10씩 공간을 주고, 이 view를 safearea top: 10, leading: 10, horizontal center 설정을 해주었다.</p>

<p>그리고 이 화면을 복사하고 empty라는 파일을 만들어서 파일이름을 InputView로 하고 여기에 붙여넣는다 이 파일을 nib 파일(인터페이스 빌더)이라고 부른다.</p>

<p><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904154758361.png" alt="이미지" width="30%" /></p>

<p><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904155040418.png" alt="이미지" width="30%" /></p>

<p>그럼 InputView에서 이렇게 깨지는데 사이즈 인스펙터(삼각형) 부분에서 Layout Guides에서 Safe area 제거한다. 그리고 View를 누르고 attribute(삼각형 바로 왼쪽) 눌러서 Size를 Inferred에서 Freform으로 바꾼다. 그러면 사이즈를 편하게 조절할 수 있다.</p>

<p><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904155715893.png" alt="이미지" width="70%" /><br />
file owner에서 코드 클래스를 연결한다.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 코드 클래스</span>
<span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">InputView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>
    <span class="c1">/// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder)</span>
    <span class="c1">/// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">awakeFromNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">awakeFromNib</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">/// 코드로 InputView를 생성한다면 사용하는 생성자</span>
    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">coder</span><span class="p">:</span> <span class="n">coder</span><span class="p">)</span> <span class="c1">// 스토리보드용</span>
        <span class="c1">/// fatalError("init(coder:) has not been implemented") // 코드용</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904160046690.png" alt="이미지" width="30%" /><br />
View를 생성후 노란색 View에 드래그해서 Vertical Spacing, Leading, Trailing, Equal Height 설정을 해준다.</p>

<p><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904160335271.png" alt="이미지" width="30%" /><br />
새로 만든 뷰를 SecondInputView로 하고 option + cmd + 4하고 class를 InputView로 해준다.<br />
그리고 실행해보면 아래 awakefromnib은 탔다고 로그가 뜨지만 우리가 원하는 Nib파일과의 연결이 안되서 여전히 민트색으로 나온다. <br />
이를 해결해보자.</p>

<table>
  <tr>
    <td><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904161610102.png" alt="Before" width="90%" /></td>
    <td><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904162604822.png" alt="After" width="80%" /></td>
  </tr>
  <tr>
    <td style="text-align:center;">Before</td>
    <td style="text-align:center;">After(applyNib 생성/호출)</td>
  </tr>
</table>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 로그</span>
<span class="kt">SwiftUILab</span><span class="o">/</span><span class="kt">InputView</span><span class="o">.</span><span class="n">swift</span> <span class="nf">init</span><span class="p">(</span><span class="nv">coder</span><span class="p">:)</span> <span class="mi">26</span> <span class="o">-</span> 
<span class="kt">SwiftUILab</span><span class="o">/</span><span class="kt">InputView</span><span class="o">.</span><span class="n">swift</span> <span class="nf">awakeFromNib</span><span class="p">()</span> <span class="mi">15</span> <span class="o">-</span> 
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>
 
<span class="kd">class</span> <span class="kt">InputView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>
    <span class="c1">/// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder)</span>
    <span class="c1">/// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">awakeFromNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">awakeFromNib</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">/// 코드로 InputView를 생성한다면 사용하는 생성자</span>
    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">coder</span><span class="p">:</span> <span class="n">coder</span><span class="p">)</span> <span class="c1">// 스토리보드용</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="c1">/// fatalError("init(coder:) has not been implemented") // 코드용</span>
    <span class="p">}</span>
    
    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">applyNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">nibName</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="k">Self</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>     <span class="c1">// 나의 타입을 가져온다 "InputView"</span>
        <span class="k">let</span> <span class="nv">nib</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">loadNibNamed</span><span class="p">(</span><span class="n">nibName</span><span class="p">,</span> <span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>  <span class="c1">// Bundle에서 Nib파일을 불러오겠다, 주인은 self</span>
        
        <span class="c1">// nib의 첫 요소를 UIView 형태로 가져오겠다</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="n">nib</span><span class="p">?</span><span class="o">.</span><span class="n">first</span> <span class="k">as?</span> <span class="kt">UIView</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        
        <span class="c1">// autoLauout</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">view</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">),</span>
        <span class="p">])</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<h2 id="추가-라벨-버튼-텍스트필드-각각-커스텀하고싶다면">추가: 라벨, 버튼, 텍스트필드 각각 커스텀하고싶다면</h2>
<p>각각 Nib에서 InputView 코드로 드래그해주고 커스텀을 하면되는데, 코드로 해도 되지만 <br />
@IBInspactable를 활용하면 Interface Builder에서 편하게 수정할 수 있다.<br />
수정은 Main 즉 호출쪽에서 UserDefined Runtime Attributes에서 넣어주면 된다.</p>

<table>
  <tr>
    <td><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904164204030.png" alt="Before" width="80%" /></td>
    <td><img src="/assets/img/2025-09-04-%5BCustomView%5D-customView1/image-20250904164312431.png" alt="After" width="80%" /></td>
  </tr>
  <tr>
    <td style="text-align:center;">파란칸 작성</td>
    <td style="text-align:center;">실행 화면</td>
  </tr>
</table>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>
 
<span class="kd">class</span> <span class="kt">InputView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">inputTextField</span><span class="p">:</span> <span class="kt">UITextField</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonA</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonB</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="c1">// @IBInspectable: Interface Builder에서 속성을 넣어주는 역할</span>
    <span class="c1">// 프로퍼티 옵저버</span>
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">title</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">?</span> <span class="s">"글자를 입력해주세요"</span> <span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">/// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder)</span>
    <span class="c1">/// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">awakeFromNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">awakeFromNib</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">/// 코드로 InputView를 생성한다면 사용하는 생성자</span>
    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">coder</span><span class="p">:</span> <span class="n">coder</span><span class="p">)</span> <span class="c1">// 스토리보드용</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="c1">/// fatalError("init(coder:) has not been implemented") // 코드용</span>
    <span class="p">}</span>
    
    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">applyNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">nibName</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="k">Self</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>     <span class="c1">// 나의 타입을 가져온다 "InputView"</span>
        <span class="k">let</span> <span class="nv">nib</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">loadNibNamed</span><span class="p">(</span><span class="n">nibName</span><span class="p">,</span> <span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>  <span class="c1">// Bundle에서 Nib파일을 불러오겠다, 주인은 self</span>
        
        <span class="c1">// nib의 첫 요소를 UIView 형태로 가져오겠다</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="n">nib</span><span class="p">?</span><span class="o">.</span><span class="n">first</span> <span class="k">as?</span> <span class="kt">UIView</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        
        <span class="c1">// autoLauout</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">view</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">),</span>
        <span class="p">])</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="코드로-ui-만드는법">코드로 UI 만드는법</h2>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">CustomStoryboardViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">secondInputView</span><span class="p">:</span> <span class="kt">InputView</span><span class="o">!</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">loadView</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">loadView</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">thirdInputView</span> <span class="o">=</span> <span class="kt">InputView</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"편의생성자 타이틀"</span><span class="p">,</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="s">"편의생성자 홀더"</span><span class="p">)</span>
        <span class="n">thirdInputView</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">thirdInputView</span><span class="p">)</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">thirdInputView</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">secondInputView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">thirdInputView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">secondInputView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">thirdInputView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">secondInputView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">thirdInputView</span><span class="o">.</span><span class="n">heightAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">secondInputView</span><span class="o">.</span><span class="n">heightAnchor</span><span class="p">)</span>
        <span class="p">])</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        
    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// override init(frame: CGRect)에 applyNib 호출 추가, 편의생성자 추가하여 뷰 생성시 title, placeHolder 파라미터 받기</span>
<span class="kd">import</span> <span class="kt">UIKit</span>
 
<span class="kd">class</span> <span class="kt">InputView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">inputTextField</span><span class="p">:</span> <span class="kt">UITextField</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonA</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonB</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="c1">// @IBInspectable: Interface Builder에서 속성을 넣어주는 역할</span>
    <span class="c1">// 프로퍼티 옵저버</span>
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">title</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">?</span> <span class="s">"글자를 입력해주세요"</span> <span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">/// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder)</span>
    <span class="c1">/// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">awakeFromNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">awakeFromNib</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">/// 코드로 InputView를 생성한다면 사용하는 생성자</span>
    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span> <span class="c1">// MARK: - 이거 추가</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 편의생성자 추가</span>
    <span class="kd">convenience</span> <span class="nf">init</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span><span class="p">,</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">placeHolder</span>
    <span class="p">}</span>
    
    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">coder</span><span class="p">:</span> <span class="n">coder</span><span class="p">)</span> <span class="c1">// 스토리보드용</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="c1">/// fatalError("init(coder:) has not been implemented") // 코드용</span>
    <span class="p">}</span>
    
    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">applyNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">nibName</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="k">Self</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>     <span class="c1">// 나의 타입을 가져온다 "InputView"</span>
        <span class="k">let</span> <span class="nv">nib</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">loadNibNamed</span><span class="p">(</span><span class="n">nibName</span><span class="p">,</span> <span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>  <span class="c1">// Bundle에서 Nib파일을 불러오겠다, 주인은 self</span>
        
        <span class="c1">// nib의 첫 요소를 UIView 형태로 가져오겠다</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="n">nib</span><span class="p">?</span><span class="o">.</span><span class="n">first</span> <span class="k">as?</span> <span class="kt">UIView</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        
        <span class="c1">// autoLauout</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">view</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">),</span>
        <span class="p">])</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="버튼-연결-추가법">버튼 연결 추가법</h2>
<p>applyNib 메서드를 추가하면된다.</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>
 
<span class="kd">class</span> <span class="kt">InputView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">inputTextField</span><span class="p">:</span> <span class="kt">UITextField</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonA</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonB</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="c1">// @IBInspectable: Interface Builder에서 속성을 넣어주는 역할</span>
    <span class="c1">// 프로퍼티 옵저버</span>
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">title</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">?</span> <span class="s">"글자를 입력해주세요"</span> <span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">/// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder)</span>
    <span class="c1">/// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">awakeFromNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">awakeFromNib</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span>
        <span class="nf">applyAction</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">/// 코드로 InputView를 생성한다면 사용하는 생성자</span>
    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span> <span class="c1">// MARK: - 이거 추가</span>
        <span class="nf">applyAction</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 편의생성자 추가</span>
    <span class="kd">convenience</span> <span class="nf">init</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span><span class="p">,</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">placeHolder</span>
    <span class="p">}</span>
    
    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">coder</span><span class="p">:</span> <span class="n">coder</span><span class="p">)</span> <span class="c1">// 스토리보드용</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="c1">/// fatalError("init(coder:) has not been implemented") // 코드용</span>
    <span class="p">}</span>
    
    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">applyNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">nibName</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="k">Self</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>     <span class="c1">// 나의 타입을 가져온다 "InputView"</span>
        <span class="k">let</span> <span class="nv">nib</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">loadNibNamed</span><span class="p">(</span><span class="n">nibName</span><span class="p">,</span> <span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>  <span class="c1">// Bundle에서 Nib파일을 불러오겠다, 주인은 self</span>
        
        <span class="c1">// nib의 첫 요소를 UIView 형태로 가져오겠다</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="n">nib</span><span class="p">?</span><span class="o">.</span><span class="n">first</span> <span class="k">as?</span> <span class="kt">UIView</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        
        <span class="c1">// autoLauout</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">view</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">),</span>
        <span class="p">])</span>
    <span class="p">}</span>
    
    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">applyAction</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonA</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnAClicked</span><span class="p">(</span><span class="nv">selder</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonB</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnBClicked</span><span class="p">(</span><span class="nv">selder</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">InputView</span> <span class="p">{</span>
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onBtnAClicked</span><span class="p">(</span><span class="nv">selder</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onBtnBClicked</span><span class="p">(</span><span class="nv">selder</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="텍스트필드-연결-추가법">텍스트필드 연결 추가법</h2>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>
 
<span class="kd">class</span> <span class="kt">InputView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">inputTextField</span><span class="p">:</span> <span class="kt">UITextField</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonA</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonB</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="c1">// @IBInspectable: Interface Builder에서 속성을 넣어주는 역할</span>
    <span class="c1">// 프로퍼티 옵저버</span>
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">title</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">?</span> <span class="s">"글자를 입력해주세요"</span> <span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">/// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder)</span>
    <span class="c1">/// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">awakeFromNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">awakeFromNib</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span>
        <span class="nf">applyAction</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">/// 코드로 InputView를 생성한다면 사용하는 생성자</span>
    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span> <span class="c1">// MARK: - 이거 추가</span>
        <span class="nf">applyAction</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 편의생성자 추가</span>
    <span class="kd">convenience</span> <span class="nf">init</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span><span class="p">,</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">placeHolder</span>
    <span class="p">}</span>
    
    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">coder</span><span class="p">:</span> <span class="n">coder</span><span class="p">)</span> <span class="c1">// 스토리보드용</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="c1">/// fatalError("init(coder:) has not been implemented") // 코드용</span>
    <span class="p">}</span>
    
    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">applyNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">nibName</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="k">Self</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>     <span class="c1">// 나의 타입을 가져온다 "InputView"</span>
        <span class="k">let</span> <span class="nv">nib</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">loadNibNamed</span><span class="p">(</span><span class="n">nibName</span><span class="p">,</span> <span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>  <span class="c1">// Bundle에서 Nib파일을 불러오겠다, 주인은 self</span>
        
        <span class="c1">// nib의 첫 요소를 UIView 형태로 가져오겠다</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="n">nib</span><span class="p">?</span><span class="o">.</span><span class="n">first</span> <span class="k">as?</span> <span class="kt">UIView</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        
        <span class="c1">// autoLauout</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">view</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">),</span>
        <span class="p">])</span>
    <span class="p">}</span>
    
    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">applyAction</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonA</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnAClicked</span><span class="p">(</span><span class="nv">selder</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonB</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnBClicked</span><span class="p">(</span><span class="nv">selder</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onInputChanged</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="p">)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">editingChanged</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">InputView</span> <span class="p">{</span>
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onBtnAClicked</span><span class="p">(</span><span class="nv">selder</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onBtnBClicked</span><span class="p">(</span><span class="nv">selder</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 텍스트필드 이벤트 받는법 delegate도 되지만 간단하게 selector로도 된다</span>
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onInputChanged</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">UITextField</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- input: </span><span class="se">\(</span><span class="n">sender</span><span class="o">.</span><span class="n">text</span><span class="o">!</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="액션을-viewcontroller에서-받고-싶다">액션을 viewController에서 받고 싶다</h2>
<ul>
  <li>클로저를 활용하자.</li>
  <li>클로저는 정의, 할당, 호출 3가지를 기억하면 된다.</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//</span>
<span class="c1">//  InputView.swift</span>
<span class="c1">//  SwiftUILab</span>
<span class="c1">//</span>
<span class="c1">//  Created by 김동현 on 9/4/25.</span>
<span class="c1">//</span>

<span class="kd">import</span> <span class="kt">UIKit</span>
 
<span class="kd">class</span> <span class="kt">InputView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">inputTextField</span><span class="p">:</span> <span class="kt">UITextField</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonA</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">buttonB</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>
    
    <span class="k">var</span> <span class="nv">onBtnAClicked</span><span class="p">:</span> <span class="p">(()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>
    <span class="k">var</span> <span class="nv">onBtnBClicked</span><span class="p">:</span> <span class="p">((</span><span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>
    
    <span class="c1">// @IBInspectable: Interface Builder에서 속성을 넣어주는 역할</span>
    <span class="c1">// 프로퍼티 옵저버</span>
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">title</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="kd">@IBInspectable</span>
    <span class="k">var</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span> <span class="p">{</span>
        <span class="k">didSet</span> <span class="p">{</span>
            <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="k">async</span> <span class="p">{</span>
                <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span><span class="o">.</span><span class="n">isEmpty</span> <span class="p">?</span> <span class="s">"글자를 입력해주세요"</span> <span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">placeHolder</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    
    <span class="c1">/// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder)</span>
    <span class="c1">/// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다</span>
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">awakeFromNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">awakeFromNib</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span>
        <span class="nf">applyAction</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">/// 코드로 InputView를 생성한다면 사용하는 생성자</span>
    <span class="k">override</span> <span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="kt">CGRect</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">applyNib</span><span class="p">()</span> <span class="c1">// MARK: - 이거 추가</span>
        <span class="nf">applyAction</span><span class="p">()</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 편의생성자 추가</span>
    <span class="kd">convenience</span> <span class="nf">init</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span><span class="p">,</span> <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">placeHolder</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 버튼 세번째 방식</span>
    <span class="kd">convenience</span> <span class="nf">init</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span> <span class="o">=</span> <span class="s">""</span><span class="p">,</span>
                     <span class="nv">placeHolder</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
                     <span class="nv">onBtnAClicked</span><span class="p">:</span> <span class="p">(()</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">,</span>
                     <span class="nv">onBtnBClicked</span><span class="p">:</span> <span class="p">((</span><span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Void</span><span class="p">)?</span> <span class="o">=</span> <span class="kc">nil</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">placeholder</span> <span class="o">=</span> <span class="n">placeHolder</span>
        
        <span class="k">self</span><span class="o">.</span><span class="n">onBtnAClicked</span> <span class="o">=</span> <span class="n">onBtnAClicked</span>
        <span class="k">self</span><span class="o">.</span><span class="n">onBtnBClicked</span> <span class="o">=</span> <span class="n">onBtnBClicked</span>
    <span class="p">}</span>
    
    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="nv">coder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">coder</span><span class="p">:</span> <span class="n">coder</span><span class="p">)</span> <span class="c1">// 스토리보드용</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="c1">/// fatalError("init(coder:) has not been implemented") // 코드용</span>
    <span class="p">}</span>
    
    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">applyNib</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">nibName</span> <span class="o">=</span> <span class="kt">String</span><span class="p">(</span><span class="nv">describing</span><span class="p">:</span> <span class="k">Self</span><span class="o">.</span><span class="k">self</span><span class="p">)</span>     <span class="c1">// 나의 타입을 가져온다 "InputView"</span>
        <span class="k">let</span> <span class="nv">nib</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">loadNibNamed</span><span class="p">(</span><span class="n">nibName</span><span class="p">,</span> <span class="nv">owner</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>  <span class="c1">// Bundle에서 Nib파일을 불러오겠다, 주인은 self</span>
        
        <span class="c1">// nib의 첫 요소를 UIView 형태로 가져오겠다</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="n">nib</span><span class="p">?</span><span class="o">.</span><span class="n">first</span> <span class="k">as?</span> <span class="kt">UIView</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        
        <span class="c1">// autoLauout</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">view</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">view</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">),</span>
        <span class="p">])</span>
    <span class="p">}</span>
    
    <span class="kd">fileprivate</span> <span class="kd">func</span> <span class="nf">applyAction</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonA</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnAClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonB</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnBClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onInputChanged</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="p">)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">editingChanged</span><span class="p">)</span>
    <span class="p">}</span>
    
   
    <span class="kd">func</span> <span class="nf">resetAction</span><span class="p">(</span><span class="nv">target</span><span class="p">:</span> <span class="kt">Any</span><span class="p">?,</span>
                     <span class="nv">aBtnAction</span><span class="p">:</span> <span class="kt">Selector</span><span class="p">,</span>
                     <span class="nv">bBtnAction</span><span class="p">:</span> <span class="kt">Selector</span><span class="p">,</span>
                     <span class="nv">inputChangeAction</span><span class="p">:</span> <span class="kt">Selector</span>
    <span class="p">)</span> <span class="p">{</span>
        <span class="c1">// 이전 걸려있던 액션 지우기</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonA</span><span class="o">.</span><span class="nf">removeTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnAClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonB</span><span class="o">.</span><span class="nf">removeTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnBClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="nf">removeTarget</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onInputChanged</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="p">)),</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">editingChanged</span><span class="p">)</span>
        <span class="c1">// 새 액션 넣기</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonA</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="n">aBtnAction</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">buttonB</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="n">bBtnAction</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">touchUpInside</span><span class="p">)</span>
        <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="nf">addTarget</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="nv">action</span><span class="p">:</span> <span class="n">inputChangeAction</span><span class="p">,</span> <span class="nv">for</span><span class="p">:</span> <span class="o">.</span><span class="n">editingChanged</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">InputView</span> <span class="p">{</span>
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onBtnAClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="nf">onBtnAClicked</span><span class="p">?()</span>
    <span class="p">}</span>
    
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onBtnBClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">userInput</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">inputTextField</span><span class="o">.</span><span class="n">text</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="nf">onBtnBClicked</span><span class="p">?(</span><span class="n">userInput</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 텍스트필드 이벤트 받는법 delegate도 되지만 간단하게 selector로도 된다</span>
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onInputChanged</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">UITextField</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- input: </span><span class="se">\(</span><span class="n">sender</span><span class="o">.</span><span class="n">text</span><span class="o">!</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">class</span> <span class="kt">CustomStoryboardViewController</span><span class="p">:</span> <span class="kt">UIViewController</span> <span class="p">{</span>
    
    <span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">secondInputView</span><span class="p">:</span> <span class="kt">InputView</span><span class="o">!</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">loadView</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">loadView</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
        <span class="c1">// let thirdInputView = InputView(title: "편의생성자 타이틀", placeHolder: "편의생성자 홀더")</span>
        
        <span class="c1">// MARK: - 4번 방식(생성자로 버튼 등록)</span>
        <span class="k">let</span> <span class="nv">thirdInputView</span> <span class="o">=</span> <span class="kt">InputView</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="s">"편의생성자 타이틀"</span><span class="p">,</span>
                                       <span class="nv">placeHolder</span><span class="p">:</span> <span class="s">"편의생성자 홀더"</span><span class="p">,</span>
                                       <span class="nv">onBtnAClicked</span><span class="p">:</span> <span class="p">{</span> <span class="k">self</span><span class="o">.</span><span class="nf">handleBtnACLicked</span><span class="p">()</span> <span class="p">},</span>
                                       <span class="nv">onBtnBClicked</span><span class="p">:</span> <span class="p">{</span> <span class="k">self</span><span class="o">.</span><span class="nf">handleBtnBClicked</span><span class="p">(</span><span class="nv">userInput</span><span class="p">:</span> <span class="nv">$0</span><span class="p">)</span> <span class="p">})</span>
        
        
        <span class="n">thirdInputView</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">thirdInputView</span><span class="p">)</span>
        <span class="kt">NSLayoutConstraint</span><span class="o">.</span><span class="nf">activate</span><span class="p">([</span>
            <span class="n">thirdInputView</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">secondInputView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="mi">10</span><span class="p">),</span>
            <span class="n">thirdInputView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">secondInputView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">),</span>
            <span class="n">thirdInputView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">secondInputView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">),</span>
            <span class="n">thirdInputView</span><span class="o">.</span><span class="n">heightAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">secondInputView</span><span class="o">.</span><span class="n">heightAnchor</span><span class="p">)</span>
        <span class="p">])</span>
    <span class="p">}</span>
    
    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        
        <span class="c1">// MARK: - 1번 방식(클로저로 버튼 등록)</span>
        <span class="n">secondInputView</span><span class="o">.</span><span class="n">onBtnAClicked</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"onBtnAClicked 실행됨"</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="c1">// MARK: - 2번 방식(클로저로 버튼 등록 + 클로저 파라미터 활용)</span>
        <span class="n">secondInputView</span><span class="o">.</span><span class="n">onBtnBClicked</span> <span class="o">=</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"onBtnBClicked 실행됨 / userInput: </span><span class="se">\(</span><span class="nv">$0</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="c1">// MARK: - 3번 방식(메서드로 버튼 등록)</span>
        <span class="c1">// 핸들링을 InputView가 아닌 VC에서 가능해진다</span>
        <span class="n">secondInputView</span><span class="o">.</span><span class="nf">resetAction</span><span class="p">(</span><span class="nv">target</span><span class="p">:</span> <span class="k">self</span><span class="p">,</span>
                                    <span class="nv">aBtnAction</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnAClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="p">)),</span>
                                    <span class="nv">bBtnAction</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onBtnBClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="p">)),</span>
                                    <span class="nv">inputChangeAction</span><span class="p">:</span> <span class="k">#selector</span><span class="p">(</span><span class="nf">onInputChanged</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="p">)))</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="kd">extension</span> <span class="kt">CustomStoryboardViewController</span> <span class="p">{</span>
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onBtnAClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onBtnBClicked</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">UIButton</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- "</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// MARK: - 텍스트필드 이벤트 받는법 delegate도 되지만 간단하게 selector로도 된다</span>
    <span class="kd">@objc</span> <span class="kd">func</span> <span class="nf">onInputChanged</span><span class="p">(</span><span class="nv">sender</span><span class="p">:</span> <span class="kt">UITextField</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="k">#fileID</span><span class="p">,</span> <span class="k">#function</span><span class="p">,</span> <span class="k">#line</span><span class="p">,</span> <span class="s">"- input: </span><span class="se">\(</span><span class="n">sender</span><span class="o">.</span><span class="n">text</span><span class="o">!</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">CustomStoryboardViewController</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">handleBtnACLicked</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"onBtnAClicked"</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">handleBtnBClicked</span><span class="p">(</span><span class="nv">userInput</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"onBtnBClicked"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="s">"onBtnBClicked!!!: </span><span class="se">\(</span><span class="n">userInput</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="정리">정리</h2>
<ul>
  <li>UIKit으로 커스텀 뷰 만들 때 컴포넌트 단위로 구현하는게 편하다.</li>
  <li>코드로만 만드는 방식도 있지만, 특정 부분을 Xib파일로 따로 빼서 구성할 수 있다,
    <ul>
      <li>이때는 연결을 View가 아니라 Files Owner에 원하는 UIView 클래스룰 연결해준다.</li>
      <li>해당하는 Nib파일을 가져와서 Nib파일의 첫번째 뷰를 UIView 타입으로 가져오고 오토레이아웃을 한번 잡아준다.</li>
    </ul>
  </li>
  <li>Main 스토리보드에서 UIView를 클래스 이름 연결하면 awakeFromNib을 탄다.
    <ul>
      <li>커스텀으로 속성 변경할거면 @IBInspactable를 사용하면 된다.</li>
    </ul>
  </li>
  <li>Xib파일을 코드로 생성할때는 init(frame)을 탄다
    <ul>
      <li>커스텀 속성을 넣고싶으면 convenience init을 통해 매개변수를 넣어서 해결하면 된다.</li>
    </ul>
  </li>
</ul>]]></content><author><name>Dong Hyeon</name></author><category term="CustomView" /><summary type="html"><![CDATA[커스텀뷰 만들기 우선 Storyboard에서 사진 처럼 UI를 만든다. Button을 hstack으로 묶고, label, textfield, hstack을 vstack으로 묶는다. 그리고 view를 embed하고 색성을 주고, vstack을 view로 드래그하여 상하좌우 전부 10씩 공간을 주고, 이 view를 safearea top: 10, leading: 10, horizontal center 설정을 해주었다. 그리고 이 화면을 복사하고 empty라는 파일을 만들어서 파일이름을 InputView로 하고 여기에 붙여넣는다 이 파일을 nib 파일(인터페이스 빌더)이라고 부른다. 그럼 InputView에서 이렇게 깨지는데 사이즈 인스펙터(삼각형) 부분에서 Layout Guides에서 Safe area 제거한다. 그리고 View를 누르고 attribute(삼각형 바로 왼쪽) 눌러서 Size를 Inferred에서 Freform으로 바꾼다. 그러면 사이즈를 편하게 조절할 수 있다. file owner에서 코드 클래스를 연결한다. // 코드 클래스 import UIKit class InputView: UIView { /// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder) /// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다 override func awakeFromNib() { super.awakeFromNib() print(#fileID, #function, #line, "- ") } /// 코드로 InputView를 생성한다면 사용하는 생성자 override init(frame: CGRect) { super.init(frame: frame) print(#fileID, #function, #line, "- ") } required init?(coder: NSCoder) { super.init(coder: coder) // 스토리보드용 /// fatalError("init(coder:) has not been implemented") // 코드용 } } View를 생성후 노란색 View에 드래그해서 Vertical Spacing, Leading, Trailing, Equal Height 설정을 해준다. 새로 만든 뷰를 SecondInputView로 하고 option + cmd + 4하고 class를 InputView로 해준다. 그리고 실행해보면 아래 awakefromnib은 탔다고 로그가 뜨지만 우리가 원하는 Nib파일과의 연결이 안되서 여전히 민트색으로 나온다. 이를 해결해보자. Before After(applyNib 생성/호출) // 로그 SwiftUILab/InputView.swift init(coder:) 26 - SwiftUILab/InputView.swift awakeFromNib() 15 - import UIKit class InputView: UIView { /// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder) /// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다 override func awakeFromNib() { super.awakeFromNib() print(#fileID, #function, #line, "- ") applyNib() } /// 코드로 InputView를 생성한다면 사용하는 생성자 override init(frame: CGRect) { super.init(frame: frame) print(#fileID, #function, #line, "- ") } required init?(coder: NSCoder) { super.init(coder: coder) // 스토리보드용 print(#fileID, #function, #line, "- ") /// fatalError("init(coder:) has not been implemented") // 코드용 } fileprivate func applyNib() { print(#fileID, #function, #line, "- ") let nibName = String(describing: Self.self) // 나의 타입을 가져온다 "InputView" let nib = Bundle.main.loadNibNamed(nibName, owner: self) // Bundle에서 Nib파일을 불러오겠다, 주인은 self // nib의 첫 요소를 UIView 형태로 가져오겠다 guard let view = nib?.first as? UIView else { return } // autoLauout addSubview(view) view.translatesAutoresizingMaskIntoConstraints = false NSLayoutConstraint.activate([ view.topAnchor.constraint(equalTo: self.topAnchor), view.leadingAnchor.constraint(equalTo: self.leadingAnchor), view.trailingAnchor.constraint(equalTo: self.trailingAnchor), view.bottomAnchor.constraint(equalTo: self.bottomAnchor), ]) } } 추가: 라벨, 버튼, 텍스트필드 각각 커스텀하고싶다면 각각 Nib에서 InputView 코드로 드래그해주고 커스텀을 하면되는데, 코드로 해도 되지만 @IBInspactable를 활용하면 Interface Builder에서 편하게 수정할 수 있다. 수정은 Main 즉 호출쪽에서 UserDefined Runtime Attributes에서 넣어주면 된다. 파란칸 작성 실행 화면 import UIKit class InputView: UIView { @IBOutlet weak var titleLabel: UILabel! @IBOutlet weak var inputTextField: UITextField! @IBOutlet weak var buttonA: UIButton! @IBOutlet weak var buttonB: UIButton! // @IBInspectable: Interface Builder에서 속성을 넣어주는 역할 // 프로퍼티 옵저버 @IBInspectable var title: String = "" { didSet { DispatchQueue.main.async { self.titleLabel.text = self.title } } } @IBInspectable var placeHolder: String = "" { didSet { DispatchQueue.main.async { self.inputTextField.placeholder = self.placeHolder.isEmpty ? "글자를 입력해주세요" : self.placeHolder } } } /// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder) /// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다 override func awakeFromNib() { super.awakeFromNib() print(#fileID, #function, #line, "- ") applyNib() } /// 코드로 InputView를 생성한다면 사용하는 생성자 override init(frame: CGRect) { super.init(frame: frame) print(#fileID, #function, #line, "- ") } required init?(coder: NSCoder) { super.init(coder: coder) // 스토리보드용 print(#fileID, #function, #line, "- ") /// fatalError("init(coder:) has not been implemented") // 코드용 } fileprivate func applyNib() { print(#fileID, #function, #line, "- ") let nibName = String(describing: Self.self) // 나의 타입을 가져온다 "InputView" let nib = Bundle.main.loadNibNamed(nibName, owner: self) // Bundle에서 Nib파일을 불러오겠다, 주인은 self // nib의 첫 요소를 UIView 형태로 가져오겠다 guard let view = nib?.first as? UIView else { return } // autoLauout addSubview(view) view.translatesAutoresizingMaskIntoConstraints = false NSLayoutConstraint.activate([ view.topAnchor.constraint(equalTo: self.topAnchor), view.leadingAnchor.constraint(equalTo: self.leadingAnchor), view.trailingAnchor.constraint(equalTo: self.trailingAnchor), view.bottomAnchor.constraint(equalTo: self.bottomAnchor), ]) } } 코드로 UI 만드는법 import UIKit class CustomStoryboardViewController: UIViewController { @IBOutlet weak var secondInputView: InputView! override func loadView() { super.loadView() print(#fileID, #function, #line, "- ") let thirdInputView = InputView(title: "편의생성자 타이틀", placeHolder: "편의생성자 홀더") thirdInputView.translatesAutoresizingMaskIntoConstraints = false self.view.addSubview(thirdInputView) NSLayoutConstraint.activate([ thirdInputView.topAnchor.constraint(equalTo: secondInputView.bottomAnchor, constant: 10), thirdInputView.leadingAnchor.constraint(equalTo: secondInputView.leadingAnchor), thirdInputView.trailingAnchor.constraint(equalTo: secondInputView.trailingAnchor), thirdInputView.heightAnchor.constraint(equalTo: secondInputView.heightAnchor) ]) } override func viewDidLoad() { } } // override init(frame: CGRect)에 applyNib 호출 추가, 편의생성자 추가하여 뷰 생성시 title, placeHolder 파라미터 받기 import UIKit class InputView: UIView { @IBOutlet weak var titleLabel: UILabel! @IBOutlet weak var inputTextField: UITextField! @IBOutlet weak var buttonA: UIButton! @IBOutlet weak var buttonB: UIButton! // @IBInspectable: Interface Builder에서 속성을 넣어주는 역할 // 프로퍼티 옵저버 @IBInspectable var title: String = "" { didSet { DispatchQueue.main.async { self.titleLabel.text = self.title } } } @IBInspectable var placeHolder: String = "" { didSet { DispatchQueue.main.async { self.inputTextField.placeholder = self.placeHolder.isEmpty ? "글자를 입력해주세요" : self.placeHolder } } } /// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder) /// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다 override func awakeFromNib() { super.awakeFromNib() print(#fileID, #function, #line, "- ") applyNib() } /// 코드로 InputView를 생성한다면 사용하는 생성자 override init(frame: CGRect) { super.init(frame: frame) print(#fileID, #function, #line, "- ") applyNib() // MARK: - 이거 추가 } // MARK: - 편의생성자 추가 convenience init(title: String = "", placeHolder: String) { self.init(frame: .zero) self.titleLabel.text = title self.inputTextField.placeholder = placeHolder } required init?(coder: NSCoder) { super.init(coder: coder) // 스토리보드용 print(#fileID, #function, #line, "- ") /// fatalError("init(coder:) has not been implemented") // 코드용 } fileprivate func applyNib() { print(#fileID, #function, #line, "- ") let nibName = String(describing: Self.self) // 나의 타입을 가져온다 "InputView" let nib = Bundle.main.loadNibNamed(nibName, owner: self) // Bundle에서 Nib파일을 불러오겠다, 주인은 self // nib의 첫 요소를 UIView 형태로 가져오겠다 guard let view = nib?.first as? UIView else { return } // autoLauout addSubview(view) view.translatesAutoresizingMaskIntoConstraints = false NSLayoutConstraint.activate([ view.topAnchor.constraint(equalTo: self.topAnchor), view.leadingAnchor.constraint(equalTo: self.leadingAnchor), view.trailingAnchor.constraint(equalTo: self.trailingAnchor), view.bottomAnchor.constraint(equalTo: self.bottomAnchor), ]) } } 버튼 연결 추가법 applyNib 메서드를 추가하면된다. import UIKit class InputView: UIView { @IBOutlet weak var titleLabel: UILabel! @IBOutlet weak var inputTextField: UITextField! @IBOutlet weak var buttonA: UIButton! @IBOutlet weak var buttonB: UIButton! // @IBInspectable: Interface Builder에서 속성을 넣어주는 역할 // 프로퍼티 옵저버 @IBInspectable var title: String = "" { didSet { DispatchQueue.main.async { self.titleLabel.text = self.title } } } @IBInspectable var placeHolder: String = "" { didSet { DispatchQueue.main.async { self.inputTextField.placeholder = self.placeHolder.isEmpty ? "글자를 입력해주세요" : self.placeHolder } } } /// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder) /// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다 override func awakeFromNib() { super.awakeFromNib() print(#fileID, #function, #line, "- ") applyNib() applyAction() } /// 코드로 InputView를 생성한다면 사용하는 생성자 override init(frame: CGRect) { super.init(frame: frame) print(#fileID, #function, #line, "- ") applyNib() // MARK: - 이거 추가 applyAction() } // MARK: - 편의생성자 추가 convenience init(title: String = "", placeHolder: String) { self.init(frame: .zero) self.titleLabel.text = title self.inputTextField.placeholder = placeHolder } required init?(coder: NSCoder) { super.init(coder: coder) // 스토리보드용 print(#fileID, #function, #line, "- ") /// fatalError("init(coder:) has not been implemented") // 코드용 } fileprivate func applyNib() { print(#fileID, #function, #line, "- ") let nibName = String(describing: Self.self) // 나의 타입을 가져온다 "InputView" let nib = Bundle.main.loadNibNamed(nibName, owner: self) // Bundle에서 Nib파일을 불러오겠다, 주인은 self // nib의 첫 요소를 UIView 형태로 가져오겠다 guard let view = nib?.first as? UIView else { return } // autoLauout addSubview(view) view.translatesAutoresizingMaskIntoConstraints = false NSLayoutConstraint.activate([ view.topAnchor.constraint(equalTo: self.topAnchor), view.leadingAnchor.constraint(equalTo: self.leadingAnchor), view.trailingAnchor.constraint(equalTo: self.trailingAnchor), view.bottomAnchor.constraint(equalTo: self.bottomAnchor), ]) } fileprivate func applyAction() { print(#fileID, #function, #line, "- ") self.buttonA.addTarget(self, action: #selector(onBtnAClicked(selder:)), for: .touchUpInside) self.buttonB.addTarget(self, action: #selector(onBtnBClicked(selder:)), for: .touchUpInside) } } extension InputView { @objc func onBtnAClicked(selder: UIButton) { print(#fileID, #function, #line, "- ") } @objc func onBtnBClicked(selder: UIButton) { print(#fileID, #function, #line, "- ") } } 텍스트필드 연결 추가법 import UIKit class InputView: UIView { @IBOutlet weak var titleLabel: UILabel! @IBOutlet weak var inputTextField: UITextField! @IBOutlet weak var buttonA: UIButton! @IBOutlet weak var buttonB: UIButton! // @IBInspectable: Interface Builder에서 속성을 넣어주는 역할 // 프로퍼티 옵저버 @IBInspectable var title: String = "" { didSet { DispatchQueue.main.async { self.titleLabel.text = self.title } } } @IBInspectable var placeHolder: String = "" { didSet { DispatchQueue.main.async { self.inputTextField.placeholder = self.placeHolder.isEmpty ? "글자를 입력해주세요" : self.placeHolder } } } /// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder) /// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다 override func awakeFromNib() { super.awakeFromNib() print(#fileID, #function, #line, "- ") applyNib() applyAction() } /// 코드로 InputView를 생성한다면 사용하는 생성자 override init(frame: CGRect) { super.init(frame: frame) print(#fileID, #function, #line, "- ") applyNib() // MARK: - 이거 추가 applyAction() } // MARK: - 편의생성자 추가 convenience init(title: String = "", placeHolder: String) { self.init(frame: .zero) self.titleLabel.text = title self.inputTextField.placeholder = placeHolder } required init?(coder: NSCoder) { super.init(coder: coder) // 스토리보드용 print(#fileID, #function, #line, "- ") /// fatalError("init(coder:) has not been implemented") // 코드용 } fileprivate func applyNib() { print(#fileID, #function, #line, "- ") let nibName = String(describing: Self.self) // 나의 타입을 가져온다 "InputView" let nib = Bundle.main.loadNibNamed(nibName, owner: self) // Bundle에서 Nib파일을 불러오겠다, 주인은 self // nib의 첫 요소를 UIView 형태로 가져오겠다 guard let view = nib?.first as? UIView else { return } // autoLauout addSubview(view) view.translatesAutoresizingMaskIntoConstraints = false NSLayoutConstraint.activate([ view.topAnchor.constraint(equalTo: self.topAnchor), view.leadingAnchor.constraint(equalTo: self.leadingAnchor), view.trailingAnchor.constraint(equalTo: self.trailingAnchor), view.bottomAnchor.constraint(equalTo: self.bottomAnchor), ]) } fileprivate func applyAction() { print(#fileID, #function, #line, "- ") self.buttonA.addTarget(self, action: #selector(onBtnAClicked(selder:)), for: .touchUpInside) self.buttonB.addTarget(self, action: #selector(onBtnBClicked(selder:)), for: .touchUpInside) self.inputTextField.addTarget(self, action: #selector(onInputChanged(sender: )), for: .editingChanged) } } extension InputView { @objc func onBtnAClicked(selder: UIButton) { print(#fileID, #function, #line, "- ") } @objc func onBtnBClicked(selder: UIButton) { print(#fileID, #function, #line, "- ") } // MARK: - 텍스트필드 이벤트 받는법 delegate도 되지만 간단하게 selector로도 된다 @objc func onInputChanged(sender: UITextField) { print(#fileID, #function, #line, "- input: \(sender.text!)") } } 액션을 viewController에서 받고 싶다 클로저를 활용하자. 클로저는 정의, 할당, 호출 3가지를 기억하면 된다. // // InputView.swift // SwiftUILab // // Created by 김동현 on 9/4/25. // import UIKit class InputView: UIView { @IBOutlet weak var titleLabel: UILabel! @IBOutlet weak var inputTextField: UITextField! @IBOutlet weak var buttonA: UIButton! @IBOutlet weak var buttonB: UIButton! var onBtnAClicked: (() -&gt; Void)? = nil var onBtnBClicked: ((String) -&gt; Void)? = nil // @IBInspectable: Interface Builder에서 속성을 넣어주는 역할 // 프로퍼티 옵저버 @IBInspectable var title: String = "" { didSet { DispatchQueue.main.async { self.titleLabel.text = self.title } } } @IBInspectable var placeHolder: String = "" { didSet { DispatchQueue.main.async { self.inputTextField.placeholder = self.placeHolder.isEmpty ? "글자를 입력해주세요" : self.placeHolder } } } /// 인터페이스 빌더로 생성이되는 생성자(nib == interfacebuilder) /// 스토리보드나 Nib을 통해 생성되면 이걸 사용한다 override func awakeFromNib() { super.awakeFromNib() print(#fileID, #function, #line, "- ") applyNib() applyAction() } /// 코드로 InputView를 생성한다면 사용하는 생성자 override init(frame: CGRect) { super.init(frame: frame) print(#fileID, #function, #line, "- ") applyNib() // MARK: - 이거 추가 applyAction() } // MARK: - 편의생성자 추가 convenience init(title: String = "", placeHolder: String) { self.init(frame: .zero) self.titleLabel.text = title self.inputTextField.placeholder = placeHolder } // MARK: - 버튼 세번째 방식 convenience init(title: String = "", placeHolder: String, onBtnAClicked: (() -&gt; Void)? = nil, onBtnBClicked: ((String) -&gt; Void)? = nil ) { self.init(frame: .zero) self.titleLabel.text = title self.inputTextField.placeholder = placeHolder self.onBtnAClicked = onBtnAClicked self.onBtnBClicked = onBtnBClicked } required init?(coder: NSCoder) { super.init(coder: coder) // 스토리보드용 print(#fileID, #function, #line, "- ") /// fatalError("init(coder:) has not been implemented") // 코드용 } fileprivate func applyNib() { print(#fileID, #function, #line, "- ") let nibName = String(describing: Self.self) // 나의 타입을 가져온다 "InputView" let nib = Bundle.main.loadNibNamed(nibName, owner: self) // Bundle에서 Nib파일을 불러오겠다, 주인은 self // nib의 첫 요소를 UIView 형태로 가져오겠다 guard let view = nib?.first as? UIView else { return } // autoLauout addSubview(view) view.translatesAutoresizingMaskIntoConstraints = false NSLayoutConstraint.activate([ view.topAnchor.constraint(equalTo: self.topAnchor), view.leadingAnchor.constraint(equalTo: self.leadingAnchor), view.trailingAnchor.constraint(equalTo: self.trailingAnchor), view.bottomAnchor.constraint(equalTo: self.bottomAnchor), ]) } fileprivate func applyAction() { print(#fileID, #function, #line, "- ") self.buttonA.addTarget(self, action: #selector(onBtnAClicked(sender:)), for: .touchUpInside) self.buttonB.addTarget(self, action: #selector(onBtnBClicked(sender:)), for: .touchUpInside) self.inputTextField.addTarget(self, action: #selector(onInputChanged(sender: )), for: .editingChanged) } func resetAction(target: Any?, aBtnAction: Selector, bBtnAction: Selector, inputChangeAction: Selector ) { // 이전 걸려있던 액션 지우기 print(#fileID, #function, #line, "- ") self.buttonA.removeTarget(self, action: #selector(onBtnAClicked(sender:)), for: .touchUpInside) self.buttonB.removeTarget(self, action: #selector(onBtnBClicked(sender:)), for: .touchUpInside) self.inputTextField.removeTarget(self, action: #selector(onInputChanged(sender: )), for: .editingChanged) // 새 액션 넣기 self.buttonA.addTarget(target, action: aBtnAction, for: .touchUpInside) self.buttonB.addTarget(target, action: bBtnAction, for: .touchUpInside) self.inputTextField.addTarget(target, action: inputChangeAction, for: .editingChanged) } } extension InputView { @objc func onBtnAClicked(sender: UIButton) { print(#fileID, #function, #line, "- ") onBtnAClicked?() } @objc func onBtnBClicked(sender: UIButton) { print(#fileID, #function, #line, "- ") guard let userInput = self.inputTextField.text else { return } onBtnBClicked?(userInput) } // MARK: - 텍스트필드 이벤트 받는법 delegate도 되지만 간단하게 selector로도 된다 @objc func onInputChanged(sender: UITextField) { print(#fileID, #function, #line, "- input: \(sender.text!)") } } import UIKit class CustomStoryboardViewController: UIViewController { @IBOutlet weak var secondInputView: InputView! override func loadView() { super.loadView() print(#fileID, #function, #line, "- ") // let thirdInputView = InputView(title: "편의생성자 타이틀", placeHolder: "편의생성자 홀더") // MARK: - 4번 방식(생성자로 버튼 등록) let thirdInputView = InputView(title: "편의생성자 타이틀", placeHolder: "편의생성자 홀더", onBtnAClicked: { self.handleBtnACLicked() }, onBtnBClicked: { self.handleBtnBClicked(userInput: $0) }) thirdInputView.translatesAutoresizingMaskIntoConstraints = false self.view.addSubview(thirdInputView) NSLayoutConstraint.activate([ thirdInputView.topAnchor.constraint(equalTo: secondInputView.bottomAnchor, constant: 10), thirdInputView.leadingAnchor.constraint(equalTo: secondInputView.leadingAnchor), thirdInputView.trailingAnchor.constraint(equalTo: secondInputView.trailingAnchor), thirdInputView.heightAnchor.constraint(equalTo: secondInputView.heightAnchor) ]) } override func viewDidLoad() { // MARK: - 1번 방식(클로저로 버튼 등록) secondInputView.onBtnAClicked = { print("onBtnAClicked 실행됨") } // MARK: - 2번 방식(클로저로 버튼 등록 + 클로저 파라미터 활용) secondInputView.onBtnBClicked = { print("onBtnBClicked 실행됨 / userInput: \($0)") } // MARK: - 3번 방식(메서드로 버튼 등록) // 핸들링을 InputView가 아닌 VC에서 가능해진다 secondInputView.resetAction(target: self, aBtnAction: #selector(onBtnAClicked(sender: )), bBtnAction: #selector(onBtnBClicked(sender: )), inputChangeAction: #selector(onInputChanged(sender: ))) } } extension CustomStoryboardViewController { @objc func onBtnAClicked(sender: UIButton) { print(#fileID, #function, #line, "- ") } @objc func onBtnBClicked(sender: UIButton) { print(#fileID, #function, #line, "- ") } // MARK: - 텍스트필드 이벤트 받는법 delegate도 되지만 간단하게 selector로도 된다 @objc func onInputChanged(sender: UITextField) { print(#fileID, #function, #line, "- input: \(sender.text!)") } } extension CustomStoryboardViewController { private func handleBtnACLicked() { print("onBtnAClicked") } private func handleBtnBClicked(userInput: String) { print("onBtnBClicked") print("onBtnBClicked!!!: \(userInput)") } } 정리 UIKit으로 커스텀 뷰 만들 때 컴포넌트 단위로 구현하는게 편하다. 코드로만 만드는 방식도 있지만, 특정 부분을 Xib파일로 따로 빼서 구성할 수 있다, 이때는 연결을 View가 아니라 Files Owner에 원하는 UIView 클래스룰 연결해준다. 해당하는 Nib파일을 가져와서 Nib파일의 첫번째 뷰를 UIView 타입으로 가져오고 오토레이아웃을 한번 잡아준다. Main 스토리보드에서 UIView를 클래스 이름 연결하면 awakeFromNib을 탄다. 커스텀으로 속성 변경할거면 @IBInspactable를 사용하면 된다. Xib파일을 코드로 생성할때는 init(frame)을 탄다 커스텀 속성을 넣고싶으면 convenience init을 통해 매개변수를 넣어서 해결하면 된다.]]></summary></entry><entry><title type="html">[AutoLayout] 5. 스택뷰 활용</title><link href="http://localhost:4000/AutoLayout-autolayout6/" rel="alternate" type="text/html" title="[AutoLayout] 5. 스택뷰 활용" /><published>2025-08-14T00:00:00+00:00</published><updated>2025-08-14T00:00:00+00:00</updated><id>http://localhost:4000/%5BAutoLayout%5D-autolayout6</id><content type="html" xml:base="http://localhost:4000/AutoLayout-autolayout6/"><![CDATA[<!-- <img src="/%EC%9D%B4%EB%AF%B8%EC%A7%80%EA%B2%BD%EB%A1%9C" alt="이미지" width="30%"> -->

<h2 id="스택뷰-활용">스택뷰 활용</h2>
<p><img src="/assets/img/2025-08-14-%5BAutoLayout%5D-autolayout6/KakaoTalk_Photo_2025-08-22-15-19-27.png" alt="이미지" width="50%" /><br />
스택뷰를 활용해서 네비게이션바와 금액 입력 바 만들어보자.</p>

<h2 id="reference">Reference</h2>
<ul>
  <li>https://wwit.design/2022/07/07/monimo/</li>
</ul>]]></content><author><name>Dong Hyeon</name></author><category term="AutoLayout" /><summary type="html"><![CDATA[스택뷰 활용 스택뷰를 활용해서 네비게이션바와 금액 입력 바 만들어보자. Reference https://wwit.design/2022/07/07/monimo/]]></summary></entry></feed>